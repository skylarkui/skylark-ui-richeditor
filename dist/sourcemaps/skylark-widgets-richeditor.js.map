{"version":3,"sources":["skylark-widgets-richeditor.js"],"names":["define","exports","module","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","langx","$","Editable","Widget","Toolbar","uploader","i18n","RichEditor","inherit","options","srcNodeRef","placeholder","defaultImage","params","upload","template","_init","editor","uploadOpts","this","opts","textarea","length","Error","data","destroy","id","count","_render","self","editable","_elm","classPrefix","body","on","e","trigger","type","toolbar","toolbarFloat","toolbarHidden","toolbarFloatOffset","_placeholder","setValue","val","trim","focus","prototype","triggerHandler","args","concat","Evented","apply","key","ref","results","el","insertBefore","wrapper","find","placeholderEl","append","blur","push","name","value","insertAfter","children","util","isEmptyNode","parseInt","css","indentWidth","show","hide","hidePopover","getValue","each","i","popover","active","closest","off","selection","clear","inputManager","focused","removeData","remove","document","window","addons","general","actions","zh-CN","blockquote","bold","code","color","coloredText","hr","image","externalImage","uploadImage","uploadFailed","uploadError","imageUrl","imageSize","imageAlt","restoreImageSize","uploading","indent","outdent","italic","link","linkText","linkUrl","linkTarget","openLinkInCurrentWindow","openLinkInNewWindow","removeLink","ol","ul","strikethrough","table","deleteRow","insertRowAbove","insertRowBelow","deleteColumn","insertColumnLeft","insertColumnRight","deleteTable","title","normalText","underline","alignment","alignCenter","alignLeft","alignRight","selectLanguage","fontScale","fontScaleXLarge","fontScaleLarge","fontScaleNormal","fontScaleSmall","fontScaleXSmall","en-US","translate","result","arguments","slice","call","locale","replace","p0","p","position","shift","Button","menu","menuWrapper","menuItem","separator","_construct","icon","text","htmlTag","disableTag","disabled","needFocus","shortcut","k","len","tag","_this","render","noFocus","param","preventDefault","hasClass","toggleClass","siblings","removeClass","is","offset","left","outerWidth","right","command","btn","currentTarget","clipboard","pasting","setActive","setDisabled","hotkeys","add","mousedown","split","inArray","formatter","_allowedTags","_status","iconClassOf","setIcon","addClass","addToolItem","appendTo","renderMenu","$menuBtnEl","$menuItemEl","ref1","menuEl","data-param","_disableStatus","endNodes","startNodes","filter","_activeStatus","endNode","startNode","node","_t","Popover","init","button","top","target","_initLabelWidth","$fields","_labelWidth","field","$field","$label","Math","max","width","$target","refresh","reflow","editorOffset","maxLeft","targetH","targetOffset","outerHeight","height","min","_Toolbar","pluginName","buttons","prependTo","constructor","addSeparator","findButton","list","addButton","AlignmentButton","align","end","status","BlockquoteButton","BoldButton","os","mac","isActive","CodePopover","lang","_tpl","langs","codeLanguages","selectEl","selected","removeAttr","CodeButton","$el","pre","decorate","undecorate","_checkMode","range","cloneContents","blockNodes","join","collapsed","inlineMode","$pre","$code","match","contents","unwrap","wrapInner","_inlineCommand","_blockCommand","blockCode","inlineCode","ColorButton","$link","$p","hex","rgb","getComputedStyle","getPropertyValue","_convertRgbToHex","fontColor","exec","r","g","b","componentToHex","c","toString","rgbToHex","EmojiButton","emoji","images","merge","_allowedAttributes","$list","dir","html","src","tpl","_i","_len","_ref","extend","imagePath","$img","clone","data-emoji","data-non-image","insertNode","FontScaleButton","FullScrennButton","cls","fullscreen","editablePadding","isFullscreen","_resize","resize","size","HrButton","HtmlButton","_resizeTextarea","htmlMode","beautifyHTML","_textareaPadding","innerHeight","scrollHeight","ImagePopover","srcEl","widthEl","heightEl","altEl","which","createRange","setRangeAfter","_loadImage","_resizeImg","inputEl","_restoreImg","alt","_initUploader","$uploadBtn","createInput","input","multiple","accept","stopPropagation","inline","img","onlySetVal","isNumber","callback","test","loadImage","blob","dataURLtoBlob","prop","ImageButton","item","imageButton","selectNode","support","onselectionchange","$contents","startContainer","eq","startOffset","$masks","mask","$mask","file","parent","cancel","$uploadItem","$input","uploadProgress","one","createImage","readImageFile","proxy","throttle","loaded","total","percent","toFixed","img_path","msg","JSON","parse","_error","success","alert","file_path","xhr","statusText","responseText","positionMask","imgOffset","wrapperOffset","Image","onload","data-image-size","isFunction","onerror","deleteContents","click","select","IndentButton","hotkey","tabIndent","ItalicButton","LinkPopover","textEl","urlEl","unlinkEl","selectTarget","throttledValueChanged","shiftKey","txtNode","createTextNode","replaceWith","LinkButton","rangeAtEndOf","noder","ListButton","MarkButton","$end","$start","save","unmark","restore","endContainer","setStartBefore","setEndAfter","mark","$mark","extractContents","index","ele","commonAncestorContainer","OrderListButton","OutdentButton","StrikethroughButton","tables","TableButton","td","col","_allowedStyles","th","_initShortcuts","_initResize","$container","containerNode","setRangeAtEndOf","keystroke","$node","_tdNav","$td","direction","$anotherTr","$tr","action","resizable","cssClasses","resizeHandle","editMenu","$table","createMenu","createTable","$trs","num","prevAll","addBack","$closestBlock","colNum","rowNum","last","after","setRangeAtStartOf","tableDecorate","row","phBr","refreshTableWidth","ret","newTr","insertRow","deleteCol","newTd","insertCol","$block","TitleButton","tagName","toLowerCase","UnderlineButton","UnorderListButton","base","Addon","widget","_widget","_options","AutoSave","currentVal","_module","autosave","autosavePath","path","href","location","pathname","storage","set","get","confirm","categoryName","addonName","supported","localStorage","setItem","removeItem","session","sessionStorage","autoSave","Dropzone","_entered","originalEvent","dataTransfer","dropEffect","imageBtn","imageFiles","_j","_len1","files","validFile","indexOf","dropzone","main"],"mappings":"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","file":"../skylark-widgets-richeditor.js","sourcesContent":["define([], function () {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    define([\n        'skylark-langx/langx',\n        'skylark-utils-dom/query',\n        'skylark-domx-contents/Editable',\n        'skylark-widgets-base/Widget',\n        './Toolbar',\n        './uploader',\n        './i18n'\n    ], function (langx, $, Editable, Widget, Toolbar, uploader, i18n) {\n        var RichEditor = Widget.inherit({\n            options: {\n                srcNodeRef: null,\n                placeholder: '',\n                defaultImage: 'images/image.png',\n                params: {},\n                upload: false,\n                template: '<div class=\"richeditor\">\\n  <div class=\"richeditor-wrapper\">\\n    <div class=\"richeditor-placeholder\"></div>\\n    <div class=\"richeditor-body\" contenteditable=\"true\">\\n    </div>\\n  </div>\\n</div>'\n            },\n            _init: function () {\n                this.opts = this.options;\n                var e, editor, uploadOpts;\n                this.textarea = $(this.opts.srcNodeRef);\n                this.opts.placeholder = this.opts.placeholder || this.textarea.attr('placeholder');\n                if (!this.textarea.length) {\n                    throw new Error('richeditor: param textarea is required.');\n                    return;\n                }\n                editor = this.textarea.data('richeditor');\n                if (editor != null) {\n                    editor.destroy();\n                }\n                this.id = ++RichEditor.count;\n                this._render();\n                var self = this;\n                this.editable = new Editable(this._elm, {\n                    classPrefix: 'richeditor-',\n                    textarea: this.textarea,\n                    body: this.body\n                });\n                this.editable.on('all', function (e, data) {\n                    return self.trigger(e.type, data);\n                });\n                if (this.opts.upload && uploader) {\n                    uploadOpts = typeof this.opts.upload === 'object' ? this.opts.upload : {};\n                    this.uploader = uploader(uploadOpts);\n                }\n                this.toolbar = new Toolbar(this, {\n                    toolbar: this.opts.toolbar,\n                    toolbarFloat: this.opts.toolbarFloat,\n                    toolbarHidden: this.opts.toolbarHidden,\n                    toolbarFloatOffset: this.opts.toolbarFloatOffset\n                });\n                if (this.opts.placeholder) {\n                    this.on('valuechanged', function () {\n                        return self._placeholder();\n                    });\n                }\n                this.setValue(this.textarea.val().trim() || '');\n                if (this.textarea.attr('autofocus')) {\n                    return self.focus();\n                }\n            }\n        });\n        RichEditor.prototype.triggerHandler = RichEditor.prototype.trigger = function (type, data) {\n            var args, ref;\n            args = [type];\n            if (data) {\n                args = args.concat(data);\n            }\n            langx.Evented.prototype.trigger.apply(this, args);\n            return this;\n        };\n        RichEditor.count = 0;\n        RichEditor.prototype._render = function () {\n            var key, ref, results, val;\n            this.el = $(this._elm).insertBefore(this.textarea);\n            this.wrapper = this.el.find('.richeditor-wrapper');\n            this.body = this.wrapper.find('.richeditor-body');\n            this.placeholderEl = this.wrapper.find('.richeditor-placeholder').append(this.opts.placeholder);\n            this.el.data('richeditor', this);\n            this.wrapper.append(this.textarea);\n            this.textarea.data('richeditor', this).blur();\n            this.body.attr('tabindex', this.textarea.attr('tabindex'));\n            if (this.opts.params) {\n                ref = this.opts.params;\n                results = [];\n                for (key in ref) {\n                    val = ref[key];\n                    results.push($('<input/>', {\n                        type: 'hidden',\n                        name: key,\n                        value: val\n                    }).insertAfter(this.textarea));\n                }\n                return results;\n            }\n        };\n        RichEditor.prototype._placeholder = function () {\n            var children;\n            children = this.body.children();\n            if (children.length === 0 || children.length === 1 && this.util.isEmptyNode(children) && parseInt(children.css('margin-left') || 0) < this.opts.indentWidth) {\n                return this.placeholderEl.show();\n            } else {\n                return this.placeholderEl.hide();\n            }\n        };\n        RichEditor.prototype.setValue = function (val) {\n            this.hidePopover();\n            this.editable.setValue(val);\n            return this.trigger('valuechanged');\n        };\n        RichEditor.prototype.getValue = function () {\n            return this.editable.getValue();\n        };\n        RichEditor.prototype.focus = function () {\n            return this.editable.focus();\n        };\n        RichEditor.prototype.blur = function () {\n            return this.editable.blur();\n        };\n        RichEditor.prototype.hidePopover = function () {\n            return this.el.find('.richeditor-popover').each(function (i, popover) {\n                popover = $(popover).data('popover');\n                if (popover.active) {\n                    return popover.hide();\n                }\n            });\n        };\n        RichEditor.prototype.destroy = function () {\n            this.triggerHandler('destroy');\n            this.textarea.closest('form').off('.richeditor .richeditor-' + this.id);\n            this.selection.clear();\n            this.inputManager.focused = false;\n            this.textarea.insertBefore(this.el).hide().val('').removeData('richeditor');\n            this.el.remove();\n            $(document).off('.richeditor-' + this.id);\n            $(window).off('.richeditor-' + this.id);\n            return this.off();\n        };\n        RichEditor.Toolbar = Toolbar;\n        RichEditor.i18n = i18n;\n        RichEditor.addons = {\n            general: {},\n            actions: {}\n        };\n        return RichEditor;\n    });\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});\ndefine(\"skylark-widgets-richeditor/RichEditor\", function(){});\n\ndefine('skylark-widgets-richeditor/i18n',[\r\n\r\n],function(){ \r\n\r\n    var i18n =  {\r\n      'zh-CN': {\r\n        'blockquote': '',\r\n        'bold': '',\r\n        'code': '',\r\n        'color': '',\r\n        'coloredText': '',\r\n        'hr': '',\r\n        'image': '',\r\n        'externalImage': '',\r\n        'uploadImage': '',\r\n        'uploadFailed': '',\r\n        'uploadError': '',\r\n        'imageUrl': '',\r\n        'imageSize': '',\r\n        'imageAlt': '',\r\n        'restoreImageSize': '',\r\n        'uploading': '',\r\n        'indent': '',\r\n        'outdent': '',\r\n        'italic': '',\r\n        'link': '',\r\n        'linkText': '',\r\n        'linkUrl': '',\r\n        'linkTarget': '',\r\n        'openLinkInCurrentWindow': '',\r\n        'openLinkInNewWindow': '',\r\n        'removeLink': '',\r\n        'ol': '',\r\n        'ul': '',\r\n        'strikethrough': '',\r\n        'table': '',\r\n        'deleteRow': '',\r\n        'insertRowAbove': '',\r\n        'insertRowBelow': '',\r\n        'deleteColumn': '',\r\n        'insertColumnLeft': '',\r\n        'insertColumnRight': '',\r\n        'deleteTable': '',\r\n        'title': '',\r\n        'normalText': '',\r\n        'underline': '',\r\n        'alignment': '',\r\n        'alignCenter': '',\r\n        'alignLeft': '',\r\n        'alignRight': '',\r\n        'selectLanguage': '',\r\n        'fontScale': '',\r\n        'fontScaleXLarge': '',\r\n        'fontScaleLarge': '',\r\n        'fontScaleNormal': '',\r\n        'fontScaleSmall': '',\r\n        'fontScaleXSmall': ''\r\n      },\r\n      'en-US': {\r\n        'blockquote': 'Block Quote',\r\n        'bold': 'Bold',\r\n        'code': 'Code',\r\n        'color': 'Text Color',\r\n        'coloredText': 'Colored Text',\r\n        'hr': 'Horizontal Line',\r\n        'image': 'Insert Image',\r\n        'externalImage': 'External Image',\r\n        'uploadImage': 'Upload Image',\r\n        'uploadFailed': 'Upload failed',\r\n        'uploadError': 'Error occurs during upload',\r\n        'imageUrl': 'Url',\r\n        'imageSize': 'Size',\r\n        'imageAlt': 'Alt',\r\n        'restoreImageSize': 'Restore Origin Size',\r\n        'uploading': 'Uploading',\r\n        'indent': 'Indent',\r\n        'outdent': 'Outdent',\r\n        'italic': 'Italic',\r\n        'link': 'Insert Link',\r\n        'linkText': 'Text',\r\n        'linkUrl': 'Url',\r\n        'linkTarget': 'Target',\r\n        'openLinkInCurrentWindow': 'Open link in current window',\r\n        'openLinkInNewWindow': 'Open link in new window',\r\n        'removeLink': 'Remove Link',\r\n        'ol': 'Ordered List',\r\n        'ul': 'Unordered List',\r\n        'strikethrough': 'Strikethrough',\r\n        'table': 'Table',\r\n        'deleteRow': 'Delete Row',\r\n        'insertRowAbove': 'Insert Row Above',\r\n        'insertRowBelow': 'Insert Row Below',\r\n        'deleteColumn': 'Delete Column',\r\n        'insertColumnLeft': 'Insert Column Left',\r\n        'insertColumnRight': 'Insert Column Right',\r\n        'deleteTable': 'Delete Table',\r\n        'title': 'Title',\r\n        'normalText': 'Text',\r\n        'underline': 'Underline',\r\n        'alignment': 'Alignment',\r\n        'alignCenter': 'Align Center',\r\n        'alignLeft': 'Align Left',\r\n        'alignRight': 'Align Right',\r\n        'selectLanguage': 'Select Language',\r\n        'fontScale': 'Font Size',\r\n        'fontScaleXLarge': 'X Large Size',\r\n        'fontScaleLarge': 'Large Size',\r\n        'fontScaleNormal': 'Normal Size',\r\n        'fontScaleSmall': 'Small Size',\r\n        'fontScaleXSmall': 'X Small Size'\r\n      },\r\n\r\n      translate : function() {\r\n        var args, key, ref, result;\r\n        key = arguments[0], args = 2 <= arguments.length ? Array.prototype.slice.call(arguments, 1) : [];\r\n        result = ((ref = i18n[this.locale]) != null ? ref[key] : void 0) || '';\r\n        if (!(args.length > 0)) {\r\n          return result;\r\n        }\r\n        result = result.replace(/([^%]|^)%(?:(\\d+)\\$)?s/g, function(p0, p, position) {\r\n          if (position) {\r\n            return p + args[parseInt(position) - 1];\r\n          } else {\r\n            return p + args.shift();\r\n          }\r\n        });\r\n        return result.replace(/%%s/g, '%s');\r\n      }\r\n\r\n    };\r\n\r\n    return i18n;\r\n});\ndefine('skylark-widgets-richeditor/Button',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\",\r\n  \"skylark-widgets-base/Widget\",\r\n  \"./RichEditor\",\r\n  \"./i18n\"\r\n],function(langx, $, Widget, RichEditor,i18n){ \r\n  var slice = [].slice;\r\n\r\n  var Button = Widget.inherit( {\r\n\r\n    options : {\r\n      template: '<li><a tabindex=\"-1\" unselectable=\"on\" class=\"toolbar-item\" href=\"javascript:;\"><span></span></a></li>',\r\n\r\n      menu : {\r\n        menuWrapper: '<div class=\"toolbar-menu\"></div>',\r\n        menuItem: '<li><a tabindex=\"-1\" unselectable=\"on\" class=\"menu-item\" href=\"javascript:;\"><span></span></a></li>',\r\n        separator: '<li><span class=\"separator\"></span></li>'      \r\n      }\r\n\r\n    },\r\n\r\n\r\n    _construct : function(opts) {\r\n      this.toolbar = opts.toolbar;\r\n      this.editor = opts.toolbar.editor;\r\n      this.title = i18n.translate(this.name);\r\n      Widget.prototype._construct.call(this,opts);\r\n    }\r\n  }); \r\n\r\n\r\n  Button.prototype.name = '';\r\n\r\n  Button.prototype.icon = '';\r\n\r\n  Button.prototype.title = '';\r\n\r\n  Button.prototype.text = '';\r\n\r\n  Button.prototype.htmlTag = '';\r\n\r\n  Button.prototype.disableTag = '';\r\n\r\n  Button.prototype.menu = false;\r\n\r\n  Button.prototype.active = false;\r\n\r\n  Button.prototype.disabled = false;\r\n\r\n  Button.prototype.needFocus = true;\r\n\r\n  Button.prototype.shortcut = null;\r\n\r\n\r\n  Button.prototype._init = function() {\r\n    var k, len, ref, tag;\r\n    this.render();\r\n    this.el.on('mousedown', (function(_this) {\r\n      return function(e) {\r\n        var exceed, noFocus, param;\r\n        e.preventDefault();\r\n        noFocus = _this.needFocus && !_this.editor.editable.inputManager.focused;\r\n        if (_this.el.hasClass('disabled')) {\r\n          return false;\r\n        }\r\n        if (noFocus) {\r\n          _this.editor.focus();\r\n        }\r\n        if (_this.menu) {\r\n          _this.wrapper.toggleClass('menu-on').siblings('li').removeClass('menu-on');\r\n          if (_this.wrapper.is('.menu-on')) {\r\n            exceed = _this.menuWrapper.offset().left + _this.menuWrapper.outerWidth() + 5 - _this.editor.wrapper.offset().left - _this.editor.wrapper.outerWidth();\r\n            if (exceed > 0) {\r\n              _this.menuWrapper.css({\r\n                'left': 'auto',\r\n                'right': 0\r\n              });\r\n            }\r\n            _this.trigger('menuexpand');\r\n          }\r\n          return false;\r\n        }\r\n        param = _this.el.data('param');\r\n        _this.command(param);\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.wrapper.on('click', 'a.menu-item', (function(_this) {\r\n      return function(e) {\r\n        var btn, noFocus, param;\r\n        e.preventDefault();\r\n        btn = $(e.currentTarget);\r\n        _this.wrapper.removeClass('menu-on');\r\n        noFocus = _this.needFocus && !_this.editor.editable.inputManager.focused;\r\n        if (btn.hasClass('disabled') || noFocus) {\r\n          return false;\r\n        }\r\n        _this.toolbar.wrapper.removeClass('menu-on');\r\n        param = btn.data('param');\r\n        _this.command(param);\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.wrapper.on('mousedown', 'a.menu-item', function(e) {\r\n      return false;\r\n    });\r\n    this.editor.on('blur', (function(_this) {\r\n      return function() {\r\n        var editorActive;\r\n        editorActive = _this.editor.body.is(':visible') && _this.editor.body.is('[contenteditable]');\r\n        if (!(editorActive && !_this.editor.editable.clipboard.pasting)) {\r\n          return;\r\n        }\r\n        _this.setActive(false);\r\n        return _this.setDisabled(false);\r\n      };\r\n    })(this));\r\n    if (this.shortcut != null) {\r\n      this.editor.editable.hotkeys.add(this.shortcut, (function(_this) {\r\n        return function(e) {\r\n          _this.el.mousedown();\r\n          return false;\r\n        };\r\n      })(this));\r\n    }\r\n    ref = this.htmlTag.split(',');\r\n    for (k = 0, len = ref.length; k < len; k++) {\r\n      tag = ref[k];\r\n      tag = langx.trim(tag);\r\n      if (tag && langx.inArray(tag, this.editor.editable.formatter._allowedTags) < 0) {\r\n        this.editor.editable.formatter._allowedTags.push(tag);\r\n      }\r\n    }\r\n    return this.editor.on('selectionchanged', (function(_this) {\r\n      return function(e) {\r\n        if (_this.editor.editable.inputManager.focused) {\r\n          return _this._status();\r\n        }\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  Button.prototype.iconClassOf = function(icon) {\r\n    if (icon) {\r\n      return \"richeditor-icon richeditor-icon-\" + icon;\r\n    } else {\r\n      return '';\r\n    }\r\n  };\r\n\r\n  Button.prototype.setIcon = function(icon) {\r\n    return this.el.find('span').removeClass().addClass(this.iconClassOf(icon)).text(this.text);\r\n  };\r\n\r\n  Button.prototype.render = function() {\r\n\r\n    //this.wrapper = $(this._tpl.item).appendTo(this.toolbar.list);\r\n    this.toolbar.addToolItem(this);\r\n    this.wrapper = $(this._elm);\r\n\r\n    this.el = this.wrapper.find('a.toolbar-item');\r\n    this.el.attr('title', this.title).addClass(\"toolbar-item-\" + this.name).data('button', this);\r\n    this.setIcon(this.icon);\r\n    if (!this.menu) {\r\n      return;\r\n    }\r\n    this.menuWrapper = $(this.options.menu.menuWrapper).appendTo(this.wrapper);\r\n    this.menuWrapper.addClass(\"toolbar-menu-\" + this.name);\r\n    return this.renderMenu();\r\n  };\r\n\r\n  Button.prototype.renderMenu = function() {\r\n    var $menuBtnEl, $menuItemEl, k, len, menuItem, ref, ref1, results;\r\n    if (!langx.isArray(this.menu)) {\r\n      return;\r\n    }\r\n    this.menuEl = $('<ul/>').appendTo(this.menuWrapper);\r\n    ref = this.menu;\r\n    results = [];\r\n    for (k = 0, len = ref.length; k < len; k++) {\r\n      menuItem = ref[k];\r\n      if (menuItem === '|') {\r\n        $(this.options.menu.separator).appendTo(this.menuEl);\r\n        continue;\r\n      }\r\n      $menuItemEl = $(this.options.menu.menuItem).appendTo(this.menuEl);\r\n      $menuBtnEl = $menuItemEl.find('a.menu-item').attr({\r\n        'title': (ref1 = menuItem.title) != null ? ref1 : menuItem.text,\r\n        'data-param': menuItem.param\r\n      }).addClass('menu-item-' + menuItem.name);\r\n      if (menuItem.icon) {\r\n        results.push($menuBtnEl.find('span').addClass(this.iconClassOf(menuItem.icon)));\r\n      } else {\r\n        results.push($menuBtnEl.find('span').text(menuItem.text));\r\n      }\r\n    }\r\n    return results;\r\n  };\r\n\r\n  Button.prototype.setActive = function(active) {\r\n    if (active === this.active) {\r\n      return;\r\n    }\r\n    this.active = active;\r\n    return this.el.toggleClass('active', this.active);\r\n  };\r\n\r\n  Button.prototype.setDisabled = function(disabled) {\r\n    if (disabled === this.disabled) {\r\n      return;\r\n    }\r\n    this.disabled = disabled;\r\n    return this.el.toggleClass('disabled', this.disabled);\r\n  };\r\n\r\n  Button.prototype._disableStatus = function() {\r\n    var disabled, endNodes, startNodes;\r\n    startNodes = this.editor.editable.selection.startNodes();\r\n    endNodes = this.editor.editable.selection.endNodes();\r\n    disabled = startNodes.filter(this.disableTag).length > 0 || endNodes.filter(this.disableTag).length > 0;\r\n    this.setDisabled(disabled);\r\n    if (this.disabled) {\r\n      this.setActive(false);\r\n    }\r\n    return this.disabled;\r\n  };\r\n\r\n  Button.prototype._activeStatus = function() {\r\n    var active, endNode, endNodes, startNode, startNodes;\r\n    startNodes = this.editor.editable.selection.startNodes();\r\n    endNodes = this.editor.editable.selection.endNodes();\r\n    startNode = startNodes.filter(this.htmlTag);\r\n    endNode = endNodes.filter(this.htmlTag);\r\n    active = startNode.length > 0 && endNode.length > 0 && startNode.is(endNode);\r\n    this.node = active ? startNode : null;\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  Button.prototype._status = function() {\r\n    this._disableStatus();\r\n    if (this.disabled) {\r\n      return;\r\n    }\r\n    return this._activeStatus();\r\n  };\r\n\r\n  Button.prototype.command = function(param) {};\r\n\r\n  Button.prototype._t = i18n.translate;\r\n  \r\n\r\n  RichEditor.Button = Button;\r\n\r\n  return Button;\r\n});\ndefine('skylark-widgets-richeditor/Popover',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\",\r\n  \"./RichEditor\",\r\n  \"./i18n\"\r\n],function(langx,$,RichEditor,i18n){ \r\n\r\n  var Popover = langx.Evented.inherit({\r\n     init : function(opts) {\r\n      this.button = opts.button;\r\n      this.editor = opts.button.editor;\r\n      this._init();\r\n    }\r\n  });\r\n\r\n\r\n  Popover.prototype.offset = {\r\n    top: 4,\r\n    left: 0\r\n  };\r\n\r\n  Popover.prototype.target = null;\r\n\r\n  Popover.prototype.active = false;\r\n\r\n  Popover.prototype._init = function() {\r\n    this.el = $('<div class=\"richeditor-popover\"></div>').appendTo(this.editor.el).data('popover', this);\r\n    this.render();\r\n    this.el.on('mouseenter', (function(_this) {\r\n      return function(e) {\r\n        return _this.el.addClass('hover');\r\n      };\r\n    })(this));\r\n    return this.el.on('mouseleave', (function(_this) {\r\n      return function(e) {\r\n        return _this.el.removeClass('hover');\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  Popover.prototype.render = function() {};\r\n\r\n  Popover.prototype._initLabelWidth = function() {\r\n    var $fields;\r\n    $fields = this.el.find('.settings-field');\r\n    if (!($fields.length > 0)) {\r\n      return;\r\n    }\r\n    this._labelWidth = 0;\r\n    $fields.each((function(_this) {\r\n      return function(i, field) {\r\n        var $field, $label;\r\n        $field = $(field);\r\n        $label = $field.find('label');\r\n        if (!($label.length > 0)) {\r\n          return;\r\n        }\r\n        return _this._labelWidth = Math.max(_this._labelWidth, $label.width());\r\n      };\r\n    })(this));\r\n    return $fields.find('label').width(this._labelWidth);\r\n  };\r\n\r\n  Popover.prototype.show = function($target, position) {\r\n    if (position == null) {\r\n      position = 'bottom';\r\n    }\r\n    if ($target == null) {\r\n      return;\r\n    }\r\n    this.el.siblings('.richeditor-popover').each(function(i, popover) {\r\n      popover = $(popover).data('popover');\r\n      if (popover.active) {\r\n        return popover.hide();\r\n      }\r\n    });\r\n    if (this.active && this.target) {\r\n      this.target.removeClass('selected');\r\n    }\r\n    this.target = $target.addClass('selected');\r\n    if (this.active) {\r\n      this.refresh(position);\r\n      return this.trigger('popovershow');\r\n    } else {\r\n      this.active = true;\r\n      this.el.css({\r\n        left: -9999\r\n      }).show();\r\n      if (!this._labelWidth) {\r\n        this._initLabelWidth();\r\n      }\r\n      this.editor.editable.util.reflow();\r\n      this.refresh(position);\r\n      return this.trigger('popovershow');\r\n    }\r\n  };\r\n\r\n  Popover.prototype.hide = function() {\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    if (this.target) {\r\n      this.target.removeClass('selected');\r\n    }\r\n    this.target = null;\r\n    this.active = false;\r\n    this.el.hide();\r\n    return this.trigger('popoverhide');\r\n  };\r\n\r\n  Popover.prototype.refresh = function(position) {\r\n    var editorOffset, left, maxLeft, targetH, targetOffset, top;\r\n    if (position == null) {\r\n      position = 'bottom';\r\n    }\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    editorOffset = this.editor.el.offset();\r\n    targetOffset = this.target.offset();\r\n    targetH = this.target.outerHeight();\r\n    if (position === 'bottom') {\r\n      top = targetOffset.top - editorOffset.top + targetH;\r\n    } else if (position === 'top') {\r\n      top = targetOffset.top - editorOffset.top - this.el.height();\r\n    }\r\n    maxLeft = this.editor.wrapper.width() - this.el.outerWidth() - 10;\r\n    left = Math.min(targetOffset.left - editorOffset.left, maxLeft);\r\n    return this.el.css({\r\n      top: top + this.offset.top,\r\n      left: left + this.offset.left\r\n    });\r\n  };\r\n\r\n  Popover.prototype.destroy = function() {\r\n    this.target = null;\r\n    this.active = false;\r\n    this.editor.off('.linkpopover');\r\n    return this.el.remove();\r\n  };\r\n\r\n  Popover.prototype._t = function(name) {\r\n    var args, ref, result;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    result = i18n.translate.apply(i18n, args);\r\n    return result;\r\n  };\r\n\r\n  RichEditor.Popover = Popover;\r\n\r\n  return Popover;\r\n\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/Toolbar',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\",\r\n  \"skylark-widgets-swt/Toolbar\"\r\n],function(langx,$,_Toolbar){ \r\n\r\n\r\n\r\n  var Toolbar = _Toolbar.inherit({\r\n    pluginName : \"lark.richeditor.toolbar\",\r\n\r\n    _construct : function(editor,opts) {\r\n      this.editor =editor;\r\n      _Toolbar.prototype._construct.call(this,opts);\r\n    },\r\n\r\n    _init : function() {\r\n      _Toolbar.prototype._init.call(this);\r\n      this._render();\r\n    }\r\n\r\n  });\r\n\r\n  Toolbar.prototype._render = function() {\r\n    var k, len, name, ref;\r\n    this.buttons = [];\r\n    //this.wrapper = $(this._tpl.wrapper).prependTo(this.editor.wrapper);\r\n    this.wrapper = $(this._elm).prependTo(this.editor.wrapper);\r\n    ref = this.opts.toolbar;\r\n    for (k = 0, len = ref.length; k < len; k++) {\r\n      name = ref[k];\r\n      if (name === '|') {\r\n        this.addSeparator();\r\n        continue;\r\n      }\r\n      if (!this.constructor.buttons[name]) {\r\n        throw new Error(\"richeditor: invalid toolbar button \" + name);\r\n        continue;\r\n      }\r\n      this.buttons.push(new this.constructor.buttons[name]({\r\n        toolbar : this,\r\n        editor: this.editor\r\n      }));\r\n    }\r\n    if (this.opts.toolbarHidden) {\r\n      return this.wrapper.hide();\r\n    }\r\n  };\r\n\r\n  Toolbar.prototype.findButton = function(name) {\r\n    var button;\r\n    button = this.list.find('.toolbar-item-' + name).data('button');\r\n    return button != null ? button : null;\r\n  };\r\n\r\n  Toolbar.addButton = function(btn) {\r\n    return this.buttons[btn.prototype.name] = btn;\r\n  };\r\n\r\n  Toolbar.buttons = {};\r\n\r\n  return Toolbar;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/AlignmentButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n   var AlignmentButton = Button.inherit({\r\n\r\n    });\r\n\r\n\r\n  AlignmentButton.prototype.name = \"alignment\";\r\n\r\n  AlignmentButton.prototype.icon = 'align-left';\r\n\r\n  AlignmentButton.prototype.htmlTag = 'p, h1, h2, h3, h4, td, th';\r\n\r\n  AlignmentButton.prototype._init = function() {\r\n    this.menu = [\r\n      {\r\n        name: 'left',\r\n        text: i18n.translate('alignLeft'),\r\n        icon: 'align-left',\r\n        param: 'left'\r\n      }, {\r\n        name: 'center',\r\n        text: i18n.translate('alignCenter'),\r\n        icon: 'align-center',\r\n        param: 'center'\r\n      }, {\r\n        name: 'right',\r\n        text: i18n.translate('alignRight'),\r\n        icon: 'align-right',\r\n        param: 'right'\r\n      }\r\n    ];\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  AlignmentButton.prototype.setActive = function(active, align) {\r\n    if (align == null) {\r\n      align = 'left';\r\n    }\r\n    if (align !== 'left' && align !== 'center' && align !== 'right') {\r\n      align = 'left';\r\n    }\r\n    if (align === 'left') {\r\n      Button.prototype.setActive.call(this, false);\r\n    } else {\r\n      Button.prototype.setActive.call(this, active);\r\n    }\r\n    this.el.removeClass('align-left align-center align-right');\r\n    if (active) {\r\n      this.el.addClass('align-' + align);\r\n    }\r\n    this.setIcon('align-' + align);\r\n    return this.menuEl.find('.menu-item').show().end().find('.menu-item-' + align).hide();\r\n  };\r\n\r\n  AlignmentButton.prototype._status = function() {\r\n    var value = this.editor.editable.status(\"alignment\",this.htmlTag);\r\n    if (value) {\r\n      this.setDisabled(false);\r\n      return this.setActive(true, value);\r\n    } else {\r\n      this.setDisabled(true);\r\n      return this.setActive(false);\r\n    }    \r\n  };\r\n\r\n  AlignmentButton.prototype.command = function(align) {\r\n    return this.editor.editable.alignment(align,this.htmlTag);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(AlignmentButton);\r\n\r\n  return AlignmentButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/BlockquoteButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n   var BlockquoteButton = Button.inherit({\r\n\r\n   });\r\n\r\n  BlockquoteButton.prototype.name = 'blockquote';\r\n\r\n  BlockquoteButton.prototype.icon = 'quote-left';\r\n\r\n  BlockquoteButton.prototype.htmlTag = 'blockquote';\r\n\r\n  BlockquoteButton.prototype.disableTag = 'pre, table';\r\n\r\n  BlockquoteButton.prototype.command = function() {\r\n    return this.editor.editable.blockquote(this.htmlTag,this.disableTag);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(BlockquoteButton); \r\n\r\n  return BlockquoteButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/BoldButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n    var BoldButton = Button.inherit({\r\n\r\n    });\r\n\r\n    BoldButton.prototype.name = 'bold';\r\n\r\n    BoldButton.prototype.icon = 'bold';\r\n\r\n    BoldButton.prototype.htmlTag = 'b, strong';\r\n\r\n    BoldButton.prototype.disableTag = 'pre';\r\n\r\n    BoldButton.prototype.shortcut = 'cmd+b';\r\n\r\n    BoldButton.prototype._init = function() {\r\n      if (this.editor.editable.util.os.mac) {\r\n        this.title = this.title + ' ( Cmd + b )';\r\n      } else {\r\n        this.title = this.title + ' ( Ctrl + b )';\r\n        this.shortcut = 'ctrl+b';\r\n      }\r\n      return Button.prototype._init.call(this);\r\n    };\r\n\r\n    BoldButton.prototype._activeStatus = function() {\r\n      var active;\r\n      active = this.editor.editable.isActive('bold');\r\n      this.setActive(active);\r\n      return this.active;\r\n    };\r\n\r\n    BoldButton.prototype.command = function() {\r\n      return this.editor.editable.bold();\r\n    };\r\n\r\n\r\n    RichEditor.Toolbar.addButton(BoldButton);\r\n\r\n    return BoldButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/CodePopover',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Popover\"\r\n],function($,Toolbar,RichEditor,Popover){ \r\n  \r\n   var CodePopover = Popover.inherit({\r\n\r\n   });\r\n\r\n  CodePopover.prototype.render = function() {\r\n    var $option, k, lang, len, ref;\r\n    this._tpl = \"<div class=\\\"code-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <select class=\\\"select-lang\\\">\\n      <option value=\\\"-1\\\">\" + (this._t('selectLanguage')) + \"</option>\\n    </select>\\n  </div>\\n</div>\";\r\n    this.langs = this.editor.opts.codeLanguages || [\r\n      {\r\n        name: 'Bash',\r\n        value: 'bash'\r\n      }, {\r\n        name: 'C++',\r\n        value: 'c++'\r\n      }, {\r\n        name: 'C#',\r\n        value: 'cs'\r\n      }, {\r\n        name: 'CSS',\r\n        value: 'css'\r\n      }, {\r\n        name: 'Erlang',\r\n        value: 'erlang'\r\n      }, {\r\n        name: 'Less',\r\n        value: 'less'\r\n      }, {\r\n        name: 'Sass',\r\n        value: 'sass'\r\n      }, {\r\n        name: 'Diff',\r\n        value: 'diff'\r\n      }, {\r\n        name: 'CoffeeScript',\r\n        value: 'coffeescript'\r\n      }, {\r\n        name: 'HTML,XML',\r\n        value: 'html'\r\n      }, {\r\n        name: 'JSON',\r\n        value: 'json'\r\n      }, {\r\n        name: 'Java',\r\n        value: 'java'\r\n      }, {\r\n        name: 'JavaScript',\r\n        value: 'js'\r\n      }, {\r\n        name: 'Markdown',\r\n        value: 'markdown'\r\n      }, {\r\n        name: 'Objective C',\r\n        value: 'oc'\r\n      }, {\r\n        name: 'PHP',\r\n        value: 'php'\r\n      }, {\r\n        name: 'Perl',\r\n        value: 'parl'\r\n      }, {\r\n        name: 'Python',\r\n        value: 'python'\r\n      }, {\r\n        name: 'Ruby',\r\n        value: 'ruby'\r\n      }, {\r\n        name: 'SQL',\r\n        value: 'sql'\r\n      }\r\n    ];\r\n    this.el.addClass('code-popover').append(this._tpl);\r\n    this.selectEl = this.el.find('.select-lang');\r\n    ref = this.langs;\r\n    for (k = 0, len = ref.length; k < len; k++) {\r\n      lang = ref[k];\r\n      $option = $('<option/>', {\r\n        text: lang.name,\r\n        value: lang.value\r\n      }).appendTo(this.selectEl);\r\n    }\r\n    this.selectEl.on('change', (function(_this) {\r\n      return function(e) {\r\n        var selected;\r\n        _this.lang = _this.selectEl.val();\r\n        selected = _this.target.hasClass('selected');\r\n        _this.target.removeClass().removeAttr('data-lang');\r\n        if (_this.lang !== -1) {\r\n          _this.target.attr('data-lang', _this.lang);\r\n        }\r\n        if (selected) {\r\n          _this.target.addClass('selected');\r\n        }\r\n        return _this.editor.trigger('valuechanged');\r\n      };\r\n    })(this));\r\n    return this.editor.on('valuechanged', (function(_this) {\r\n      return function(e) {\r\n        if (_this.active) {\r\n          return _this.refresh();\r\n        }\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  CodePopover.prototype.show = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Popover.prototype.show.apply(this, args);\r\n    this.lang = this.target.attr('data-lang');\r\n    if (this.lang != null) {\r\n      return this.selectEl.val(this.lang);\r\n    } else {\r\n      return this.selectEl.val(-1);\r\n    }\r\n  };\r\n\r\n  return CodePopover;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/CodeButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"./CodePopover\"\r\n],function($,Toolbar,RichEditor,Button,CodePopover){ \r\n  \r\n\r\n   var CodeButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n\r\n  CodeButton.prototype.name = 'code';\r\n\r\n  CodeButton.prototype.icon = 'code';\r\n\r\n  CodeButton.prototype.htmlTag = 'pre';\r\n\r\n  CodeButton.prototype.disableTag = 'ul, ol, table';\r\n\r\n  CodeButton.prototype._init = function() {\r\n    Button.prototype._init.call(this);\r\n    this.editor.on('decorate', (function(_this) {\r\n      return function(e, $el) {\r\n        return $el.find('pre').each(function(i, pre) {\r\n          return _this.decorate($(pre));\r\n        });\r\n      };\r\n    })(this));\r\n    return this.editor.on('undecorate', (function(_this) {\r\n      return function(e, $el) {\r\n        return $el.find('pre').each(function(i, pre) {\r\n          return _this.undecorate($(pre));\r\n        });\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  CodeButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Button.prototype.render.apply(this, args);\r\n    return this.popover = new CodePopover({\r\n      button: this\r\n    });\r\n  };\r\n\r\n  CodeButton.prototype._checkMode = function() {\r\n    var $blockNodes, range;\r\n    range = this.editor.editable.selection.range();\r\n    if (($blockNodes = $(range.cloneContents()).find(this.editor.editable.util.blockNodes.join(','))) > 0 || (range.collapsed && this.editor.editable.selection.startNodes().filter('code').length === 0)) {\r\n      this.inlineMode = false;\r\n      return this.htmlTag = 'pre';\r\n    } else {\r\n      this.inlineMode = true;\r\n      return this.htmlTag = 'code';\r\n    }\r\n  };\r\n\r\n  CodeButton.prototype._status = function() {\r\n    this._checkMode();\r\n    Button.prototype._status.call(this);\r\n    if (this.inlineMode) {\r\n      return;\r\n    }\r\n    if (this.active) {\r\n      return this.popover.show(this.node);\r\n    } else {\r\n      return this.popover.hide();\r\n    }\r\n  };\r\n\r\n  CodeButton.prototype.decorate = function($pre) {\r\n    var $code, lang, ref, ref1;\r\n    $code = $pre.find('> code');\r\n    if ($code.length > 0) {\r\n      lang = (ref = $code.attr('class')) != null ? (ref1 = ref.match(/lang-(\\S+)/)) != null ? ref1[1] : void 0 : void 0;\r\n      $code.contents().unwrap();\r\n      if (lang) {\r\n        return $pre.attr('data-lang', lang);\r\n      }\r\n    }\r\n  };\r\n\r\n  CodeButton.prototype.undecorate = function($pre) {\r\n    var $code, lang;\r\n    lang = $pre.attr('data-lang');\r\n    $code = $('<code/>');\r\n    if (lang && lang !== -1) {\r\n      $code.addClass('lang-' + lang);\r\n    }\r\n    return $pre.wrapInner($code).removeAttr('data-lang');\r\n  };\r\n\r\n  CodeButton.prototype.command = function() {\r\n    if (this.inlineMode) {\r\n      return this._inlineCommand();\r\n    } else {\r\n      return this._blockCommand();\r\n    }\r\n  };\r\n\r\n  CodeButton.prototype._blockCommand = function() {\r\n    return this.editor.editable.blockCode(this.htmlTag,this.disableTag);\r\n  };\r\n\r\n  CodeButton.prototype._inlineCommand = function() {\r\n    return this.editor.editable.inlineCode(this.active);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(CodeButton);    \r\n\r\n  return CodeButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/ColorButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n  \r\n\r\n   var ColorButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  ColorButton.prototype.name = 'color';\r\n\r\n  ColorButton.prototype.icon = 'tint';\r\n\r\n  ColorButton.prototype.disableTag = 'pre';\r\n\r\n  ColorButton.prototype.menu = true;\r\n\r\n  ColorButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    return Button.prototype.render.apply(this, args);\r\n  };\r\n\r\n  ColorButton.prototype.renderMenu = function() {\r\n    $('<ul class=\"color-list\">\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-1\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-2\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-3\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-4\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-5\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-6\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-7\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-default\"></a></li>\\n</ul>').appendTo(this.menuWrapper);\r\n    this.menuWrapper.on('mousedown', '.color-list', function(e) {\r\n      return false;\r\n    });\r\n    return this.menuWrapper.on('click', '.font-color', (function(_this) {\r\n      return function(e) {\r\n        var $link, $p, hex, range, rgb, textNode;\r\n        _this.wrapper.removeClass('menu-on');\r\n        $link = $(e.currentTarget);\r\n        if ($link.hasClass('font-color-default')) {\r\n          $p = _this.editor.body.find('p, li');\r\n          if (!($p.length > 0)) {\r\n            return;\r\n          }\r\n          rgb = window.getComputedStyle($p[0], null).getPropertyValue('color');\r\n          hex = _this._convertRgbToHex(rgb);\r\n        } else {\r\n          rgb = window.getComputedStyle($link[0], null).getPropertyValue('background-color');\r\n          hex = _this._convertRgbToHex(rgb);\r\n        }\r\n        if (!hex) {\r\n          return;\r\n        }\r\n\r\n        return _this.editor.editable.fontColor(hex,$link.hasClass('font-color-default'),i18n.translate('coloredText'));\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ColorButton.prototype._convertRgbToHex = function(rgb) {\r\n    var match, re, rgbToHex;\r\n    re = /rgb\\((\\d+),\\s?(\\d+),\\s?(\\d+)\\)/g;\r\n    match = re.exec(rgb);\r\n    if (!match) {\r\n      return '';\r\n    }\r\n    rgbToHex = function(r, g, b) {\r\n      var componentToHex;\r\n      componentToHex = function(c) {\r\n        var hex;\r\n        hex = c.toString(16);\r\n        if (hex.length === 1) {\r\n          return '0' + hex;\r\n        } else {\r\n          return hex;\r\n        }\r\n      };\r\n      return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n    };\r\n    return rgbToHex(match[1] * 1, match[2] * 1, match[3] * 1);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(ColorButton);\r\n\r\n  return ColorButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/EmojiButton',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function(langx,$,Toolbar,RichEditor,Button){ \r\n  \r\n\r\n   var EmojiButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  EmojiButton.i18n = {\r\n    'zh-CN': {\r\n      emoji: ''\r\n    },\r\n    'en-US': {\r\n      emoji: 'emoji'\r\n    }\r\n  };\r\n\r\n  EmojiButton.images = ['smile.png', 'smiley.png', 'laughing.png', 'blush.png', 'heart_eyes.png', 'smirk.png', 'flushed.png', 'grin.png', 'wink.png', 'kissing_closed_eyes.png', 'stuck_out_tongue_winking_eye.png', 'stuck_out_tongue.png', 'sleeping.png', 'worried.png', 'expressionless.png', 'sweat_smile.png', 'cold_sweat.png', 'joy.png', 'sob.png', 'angry.png', 'mask.png', 'scream.png', 'sunglasses.png', 'heart.png', 'broken_heart.png', 'star.png', 'anger.png', 'exclamation.png', 'question.png', 'zzz.png', 'thumbsup.png', 'thumbsdown.png', 'ok_hand.png', 'punch.png', 'v.png', 'clap.png', 'muscle.png', 'pray.png', 'skull.png', 'trollface.png'];\r\n\r\n  EmojiButton.prototype.name = 'emoji';\r\n\r\n  EmojiButton.prototype.icon = 'smile-o';\r\n\r\n  EmojiButton.prototype.menu = true;\r\n\r\n  EmojiButton.prototype._init = function() {\r\n    Button.prototype._init.apply(this);\r\n    langx.merge(this.editor.editable.formatter._allowedAttributes['img'], ['data-emoji', 'alt']);\r\n  }\r\n\r\n  EmojiButton.prototype.renderMenu = function() {\r\n    var $list, dir, html, name, opts, src, tpl, _i, _len, _ref;\r\n    tpl = '<ul class=\"emoji-list\">\\n</ul>';\r\n    opts = langx.extend({\r\n      imagePath: 'images/emoji/',\r\n      images: EmojiButton.images\r\n    }, this.editor.opts.emoji || {});\r\n    html = \"\";\r\n    dir = opts.imagePath.replace(/\\/$/, '') + '/';\r\n    _ref = opts.images;\r\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n      name = _ref[_i];\r\n      src = \"\" + dir + name;\r\n      name = name.split('.')[0];\r\n      html += \"<li data-name='\" + name + \"'><img src='\" + src + \"' width='20' height='20' alt='\" + name + \"' /></li>\";\r\n    }\r\n    $list = $(tpl);\r\n    $list.html(html).appendTo(this.menuWrapper);\r\n    return $list.on('mousedown', 'li', (function(_this) {\r\n      return function(e) {\r\n        var $img;\r\n        _this.wrapper.removeClass('menu-on');\r\n        if (!_this.editor.editable.inputManager.focused) {\r\n          return;\r\n        }\r\n        $img = $(e.currentTarget).find('img').clone().attr({\r\n          'data-emoji': true,\r\n          'data-non-image': true\r\n        });\r\n        _this.editor.editable.selection.insertNode($img);\r\n        _this.editor.trigger('valuechanged');\r\n        _this.editor.trigger('selectionchanged');\r\n        return false;\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  EmojiButton.prototype.status = function() {};\r\n\r\n\r\n  RichEditor.Toolbar.addButton(EmojiButton);\r\n\r\n  return EmojiButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/FontScaleButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n  \r\n   var FontScaleButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n\r\n  FontScaleButton.prototype.name = 'fontScale';\r\n\r\n  FontScaleButton.prototype.icon = 'font';\r\n\r\n  FontScaleButton.prototype.htmlTag = 'span';\r\n\r\n  FontScaleButton.prototype.disableTag = 'pre, h1, h2, h3, h4, h5';\r\n\r\n\r\n  FontScaleButton.prototype._init = function() {\r\n    this.menu = [\r\n      {\r\n        name: '150%',\r\n        text: i18n.translate('fontScaleXLarge'),\r\n        param: '5'\r\n      }, {\r\n        name: '125%',\r\n        text: i18n.translate('fontScaleLarge'),\r\n        param: '4'\r\n      }, {\r\n        name: '100%',\r\n        text: i18n.translate('fontScaleNormal'),\r\n        param: '3'\r\n      }, {\r\n        name: '75%',\r\n        text: i18n.translate('fontScaleSmall'),\r\n        param: '2'\r\n      }, {\r\n        name: '50%',\r\n        text: i18n.translate('fontScaleXSmall'),\r\n        param: '1'\r\n      }\r\n    ];\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  FontScaleButton.prototype._activeStatus = function() {\r\n    var active, endNode, endNodes, range, startNode, startNodes;\r\n    range = this.editor.editable.selection.range();\r\n    startNodes = this.editor.editable.selection.startNodes();\r\n    endNodes = this.editor.editable.selection.endNodes();\r\n    startNode = startNodes.filter('span[style*=\"font-size\"]');\r\n    endNode = endNodes.filter('span[style*=\"font-size\"]');\r\n    active = startNodes.length > 0 && endNodes.length > 0 && startNode.is(endNode);\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  FontScaleButton.prototype.command = function(param) {\r\n    return this.editor.editable.fontScale(param);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(FontScaleButton);\r\n\r\n  return FontScaleButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/FullScreenButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n\r\n  \r\n  var FullScrennButton = Button.inherit({\r\n    name : 'fullscreen',\r\n\r\n    needFocus : false,\r\n\r\n    _init : function() {\r\n      Button.prototype._init.call(this);\r\n\r\n      this.window = $(window);\r\n      this.body = $('body');\r\n      this.editable = this.editor.body;\r\n      return this.toolbar = this.toolbar.wrapper;\r\n    }\r\n\r\n  });\r\n\r\n\r\n\r\n  FullScrennButton.cls = 'richeditor-fullscreen';\r\n\r\n  FullScrennButton.i18n = {\r\n    'zh-CN': {\r\n      fullscreen: ''\r\n    }\r\n  };\r\n\r\n  FullScrennButton.prototype.iconClassOf = function() {\r\n    return 'icon-fullscreen';\r\n  };\r\n\r\n\r\n  FullScrennButton.prototype.status = function() {\r\n    return this.setActive(this.body.hasClass(this.constructor.cls));\r\n  };\r\n\r\n  FullScrennButton.prototype.command = function() {\r\n    var editablePadding, isFullscreen;\r\n    this.body.toggleClass(this.constructor.cls);\r\n    isFullscreen = this.body.hasClass(this.constructor.cls);\r\n    if (isFullscreen) {\r\n      editablePadding = this.editable.outerHeight() - this.editable.height();\r\n      this.window.on(\"resize.richeditor-fullscreen-\" + this.editor.id, (function(_this) {\r\n        return function() {\r\n          return _this._resize({\r\n            height: _this.window.height() - _this.toolbar.outerHeight() - editablePadding\r\n          });\r\n        };\r\n      })(this)).resize();\r\n    } else {\r\n      this.window.off(\"resize.richeditor-fullscreen-\" + this.editor.id).resize();\r\n      this._resize({\r\n        height: 'auto'\r\n      });\r\n    }\r\n    return this.setActive(isFullscreen);\r\n  };\r\n\r\n  FullScrennButton.prototype._resize = function(size) {\r\n    return this.editable.height(size.height);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(FullScrennButton);\r\n\r\n  return FullScrennButton;\r\n\r\n }); \ndefine('skylark-widgets-richeditor/buttons/HrButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n\r\n   var HrButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  HrButton.prototype.name = 'hr';\r\n\r\n  HrButton.prototype.icon = 'minus';\r\n\r\n  HrButton.prototype.htmlTag = 'hr';\r\n\r\n  HrButton.prototype._status = function() {};\r\n\r\n  HrButton.prototype.command = function() {\r\n    return this.editor.editable.hr();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(HrButton);\r\n\r\n  return HrButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/HtmlButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n   var  hasProp = {}.hasOwnProperty,\r\n        slice = [].slice;\r\n  \r\n\r\n   var HtmlButton = Button.inherit({\r\n\r\n   });\r\n\r\n  HtmlButton.prototype.name = 'html';\r\n\r\n  HtmlButton.prototype.icon = 'html5';\r\n\r\n  HtmlButton.prototype.needFocus = false;\r\n\r\n  HtmlButton.prototype._init = function() {\r\n    Button.prototype._init.call(this);\r\n    this.editor.textarea.on('focus', (function(_this) {\r\n      return function(e) {\r\n        return _this.editor.el.addClass('focus').removeClass('error');\r\n      };\r\n    })(this));\r\n    this.editor.textarea.on('blur', (function(_this) {\r\n      return function(e) {\r\n        _this.editor.el.removeClass('focus');\r\n        return _this.editor.setValue(_this.editor.textarea.val());\r\n      };\r\n    })(this));\r\n    return this.editor.textarea.on('input', (function(_this) {\r\n      return function(e) {\r\n        return _this._resizeTextarea();\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  HtmlButton.prototype.status = function() {};\r\n\r\n  HtmlButton.prototype.command = function() {\r\n    var button, i, len, ref;\r\n    this.editor.blur();\r\n    this.editor.el.toggleClass('richeditor-html');\r\n    this.editor.htmlMode = this.editor.el.hasClass('richeditor-html');\r\n    if (this.editor.htmlMode) {\r\n      this.editor.hidePopover();\r\n      this.editor.textarea.val(this.beautifyHTML(this.editor.textarea.val()));\r\n      this._resizeTextarea();\r\n    } else {\r\n      this.editor.setValue(this.editor.textarea.val());\r\n    }\r\n    ref = this.editor.toolbar.buttons;\r\n    for (i = 0, len = ref.length; i < len; i++) {\r\n      button = ref[i];\r\n      if (button.name === 'html') {\r\n        button.setActive(this.editor.htmlMode);\r\n      } else {\r\n        button.setDisabled(this.editor.htmlMode);\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  HtmlButton.prototype.beautifyHTML = function() {\r\n    return arguments[0];\r\n    var args;\r\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\r\n    if (beautify.html) {\r\n      return beautify.html.apply(beautify, args);\r\n    } else {\r\n      return beautify.apply(null, args);\r\n    }\r\n  };\r\n\r\n  HtmlButton.prototype._resizeTextarea = function() {\r\n    this._textareaPadding || (this._textareaPadding = this.editor.textarea.innerHeight() - this.editor.textarea.height());\r\n    return this.editor.textarea.height(this.editor.textarea[0].scrollHeight - this._textareaPadding);\r\n  };\r\n  RichEditor.Toolbar.addButton(HtmlButton);\r\n\r\n  return HtmlButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/ImagePopover',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Popover\"\r\n],function(langx, $,Toolbar,RichEditor,Popover){ \r\n   var ImagePopover = Popover.inherit({\r\n\r\n   });\r\n\r\n  ImagePopover.prototype.offset = {\r\n    top: 6,\r\n    left: -4\r\n  };\r\n\r\n  ImagePopover.prototype.render = function() {\r\n    var tpl;\r\n    tpl = \"<div class=\\\"link-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('imageUrl')) + \"</label>\\n    <input class=\\\"image-src\\\" type=\\\"text\\\" tabindex=\\\"1\\\" />\\n    <a class=\\\"btn-upload\\\" href=\\\"javascript:;\\\"\\n      title=\\\"\" + (this._t('uploadImage')) + \"\\\" tabindex=\\\"-1\\\">\\n      <span class=\\\"richeditor-icon richeditor-icon-upload\\\"></span>\\n    </a>\\n  </div>\\n  <div class='settings-field'>\\n    <label>\" + (this._t('imageAlt')) + \"</label>\\n    <input class=\\\"image-alt\\\" id=\\\"image-alt\\\" type=\\\"text\\\" tabindex=\\\"1\\\" />\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('imageSize')) + \"</label>\\n    <input class=\\\"image-size\\\" id=\\\"image-width\\\" type=\\\"text\\\" tabindex=\\\"2\\\" />\\n    <span class=\\\"times\\\"></span>\\n    <input class=\\\"image-size\\\" id=\\\"image-height\\\" type=\\\"text\\\" tabindex=\\\"3\\\" />\\n    <a class=\\\"btn-restore\\\" href=\\\"javascript:;\\\"\\n      title=\\\"\" + (this._t('restoreImageSize')) + \"\\\" tabindex=\\\"-1\\\">\\n      <span class=\\\"richeditor-icon richeditor-icon-undo\\\"></span>\\n    </a>\\n  </div>\\n</div>\";\r\n    this.el.addClass('image-popover').append(tpl);\r\n    this.srcEl = this.el.find('.image-src');\r\n    this.widthEl = this.el.find('#image-width');\r\n    this.heightEl = this.el.find('#image-height');\r\n    this.altEl = this.el.find('#image-alt');\r\n    this.srcEl.on('keydown', (function(_this) {\r\n      return function(e) {\r\n        var range;\r\n        if (!(e.which === 13 && !_this.target.hasClass('uploading'))) {\r\n          return;\r\n        }\r\n        e.preventDefault();\r\n        range = document.createRange();\r\n        _this.button.editor.editable.selection.setRangeAfter(_this.target, range);\r\n        return _this.hide();\r\n      };\r\n    })(this));\r\n    this.srcEl.on('blur', (function(_this) {\r\n      return function(e) {\r\n        return _this._loadImage(_this.srcEl.val());\r\n      };\r\n    })(this));\r\n    this.el.find('.image-size').on('blur', (function(_this) {\r\n      return function(e) {\r\n        _this._resizeImg($(e.currentTarget));\r\n        return _this.el.data('popover').refresh();\r\n      };\r\n    })(this));\r\n    this.el.find('.image-size').on('keyup', (function(_this) {\r\n      return function(e) {\r\n        var inputEl;\r\n        inputEl = $(e.currentTarget);\r\n        if (!(e.which === 13 || e.which === 27 || e.which === 9)) {\r\n          return _this._resizeImg(inputEl, true);\r\n        }\r\n      };\r\n    })(this));\r\n    this.el.find('.image-size').on('keydown', (function(_this) {\r\n      return function(e) {\r\n        var $img, inputEl, range;\r\n        inputEl = $(e.currentTarget);\r\n        if (e.which === 13 || e.which === 27) {\r\n          e.preventDefault();\r\n          if (e.which === 13) {\r\n            _this._resizeImg(inputEl);\r\n          } else {\r\n            _this._restoreImg();\r\n          }\r\n          $img = _this.target;\r\n          _this.hide();\r\n          range = document.createRange();\r\n          return _this.button.editor.editable.selection.setRangeAfter($img, range);\r\n        } else if (e.which === 9) {\r\n          return _this.el.data('popover').refresh();\r\n        }\r\n      };\r\n    })(this));\r\n    this.altEl.on('keydown', (function(_this) {\r\n      return function(e) {\r\n        var range;\r\n        if (e.which === 13) {\r\n          e.preventDefault();\r\n          range = document.createRange();\r\n          _this.button.editor.editable.selection.setRangeAfter(_this.target, range);\r\n          return _this.hide();\r\n        }\r\n      };\r\n    })(this));\r\n    this.altEl.on('keyup', (function(_this) {\r\n      return function(e) {\r\n        if (e.which === 13 || e.which === 27 || e.which === 9) {\r\n          return;\r\n        }\r\n        _this.alt = _this.altEl.val();\r\n        return _this.target.attr('alt', _this.alt);\r\n      };\r\n    })(this));\r\n    this.el.find('.btn-restore').on('click', (function(_this) {\r\n      return function(e) {\r\n        _this._restoreImg();\r\n        return _this.el.data('popover').refresh();\r\n      };\r\n    })(this));\r\n    this.editor.on('valuechanged', (function(_this) {\r\n      return function(e) {\r\n        if (_this.active) {\r\n          return _this.refresh();\r\n        }\r\n      };\r\n    })(this));\r\n    return this._initUploader();\r\n  };\r\n\r\n  ImagePopover.prototype._initUploader = function() {\r\n    var $uploadBtn, createInput;\r\n    $uploadBtn = this.el.find('.btn-upload');\r\n    if (this.editor.uploader == null) {\r\n      $uploadBtn.remove();\r\n      return;\r\n    }\r\n    createInput = (function(_this) {\r\n      return function() {\r\n        if (_this.input) {\r\n          _this.input.remove();\r\n        }\r\n        return _this.input = $('<input/>', {\r\n          type: 'file',\r\n          title: _this._t('uploadImage'),\r\n          multiple: true,\r\n          accept: 'image/gif,image/jpeg,image/jpg,image/png,image/svg'\r\n        }).appendTo($uploadBtn);\r\n      };\r\n    })(this);\r\n    createInput();\r\n    this.el.on('click mousedown', 'input[type=file]', function(e) {\r\n      return e.stopPropagation();\r\n    });\r\n    return this.el.on('change', 'input[type=file]', (function(_this) {\r\n      return function(e) {\r\n        _this.editor.uploader.upload(_this.input, {\r\n          inline: true,\r\n          img: _this.target\r\n        });\r\n        return createInput();\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ImagePopover.prototype._resizeImg = function(inputEl, onlySetVal) {\r\n    var height, value, width;\r\n    if (onlySetVal == null) {\r\n      onlySetVal = false;\r\n    }\r\n    value = inputEl.val() * 1;\r\n    if (!(this.target && (langx.isNumber(value) || value < 0))) {\r\n      return;\r\n    }\r\n    if (inputEl.is(this.widthEl)) {\r\n      width = value;\r\n      height = this.height * value / this.width;\r\n      this.heightEl.val(height);\r\n    } else {\r\n      height = value;\r\n      width = this.width * value / this.height;\r\n      this.widthEl.val(width);\r\n    }\r\n    if (!onlySetVal) {\r\n      this.target.attr({\r\n        width: width,\r\n        height: height\r\n      });\r\n      return this.editor.trigger('valuechanged');\r\n    }\r\n  };\r\n\r\n  ImagePopover.prototype._restoreImg = function() {\r\n    var ref, size;\r\n    size = ((ref = this.target.data('image-size')) != null ? ref.split(\",\") : void 0) || [this.width, this.height];\r\n    this.target.attr({\r\n      width: size[0] * 1,\r\n      height: size[1] * 1\r\n    });\r\n    this.widthEl.val(size[0]);\r\n    this.heightEl.val(size[1]);\r\n    return this.editor.trigger('valuechanged');\r\n  };\r\n\r\n  ImagePopover.prototype._loadImage = function(src, callback) {\r\n    if (/^data:image/.test(src) && !this.editor.uploader) {\r\n      if (callback) {\r\n        callback(false);\r\n      }\r\n      return;\r\n    }\r\n    if (this.target.attr('src') === src) {\r\n      return;\r\n    }\r\n    return this.button.loadImage(this.target, src, (function(_this) {\r\n      return function(img) {\r\n        var blob;\r\n        if (!img) {\r\n          return;\r\n        }\r\n        if (_this.active) {\r\n          _this.width = img.width;\r\n          _this.height = img.height;\r\n          _this.widthEl.val(_this.width);\r\n          _this.heightEl.val(_this.height);\r\n        }\r\n        if (/^data:image/.test(src)) {\r\n          blob = _this.editor.editable.util.dataURLtoBlob(src);\r\n          blob.name = \"Base64 Image.png\";\r\n          _this.editor.uploader.upload(blob, {\r\n            inline: true,\r\n            img: _this.target\r\n          });\r\n        } else {\r\n          _this.editor.trigger('valuechanged');\r\n        }\r\n        if (callback) {\r\n          return callback(img);\r\n        }\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ImagePopover.prototype.show = function() {\r\n    var $img, args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Popover.prototype.show.apply(this, args);\r\n    $img = this.target;\r\n    this.width = $img.width();\r\n    this.height = $img.height();\r\n    this.alt = $img.attr('alt');\r\n    if ($img.hasClass('uploading')) {\r\n      return this.srcEl.val(this._t('uploading')).prop('disabled', true);\r\n    } else {\r\n      this.srcEl.val($img.attr('src')).prop('disabled', false);\r\n      this.widthEl.val(this.width);\r\n      this.heightEl.val(this.height);\r\n      return this.altEl.val(this.alt);\r\n    }\r\n  };\r\n\r\n  return ImagePopover;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/ImageButton',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"./ImagePopover\",\r\n  \"../i18n\"\r\n],function(langx, $,Toolbar,RichEditor,Button,ImagePopover,i18n){ \r\n   var ImageButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  ImageButton.prototype.name = 'image';\r\n\r\n  ImageButton.prototype.icon = 'picture-o';\r\n\r\n  ImageButton.prototype.htmlTag = 'img';\r\n\r\n  ImageButton.prototype.disableTag = 'pre, table';\r\n\r\n  ImageButton.prototype.defaultImage = '';\r\n\r\n  ImageButton.prototype.needFocus = false;\r\n\r\n  ImageButton.prototype._init = function() {\r\n    var item, k, len, ref;\r\n    if (this.editor.opts.imageButton) {\r\n      if (Array.isArray(this.editor.opts.imageButton)) {\r\n        this.menu = [];\r\n        ref = this.editor.opts.imageButton;\r\n        for (k = 0, len = ref.length; k < len; k++) {\r\n          item = ref[k];\r\n          this.menu.push({\r\n            name: item + '-image',\r\n            text: this._t(item + 'Image')\r\n          });\r\n        }\r\n      } else {\r\n        this.menu = false;\r\n      }\r\n    } else {\r\n      if (this.editor.uploader != null) {\r\n        this.menu = [\r\n          {\r\n            name: 'upload-image',\r\n            text: i18n.translate('uploadImage')\r\n          }, {\r\n            name: 'external-image',\r\n            text: i18n.translate('externalImage')\r\n          }\r\n        ];\r\n      } else {\r\n        this.menu = false;\r\n      }\r\n    }\r\n    this.defaultImage = this.editor.opts.defaultImage;\r\n    this.editor.body.on('click', 'img:not([data-non-image])', (function(_this) {\r\n      return function(e) {\r\n        var $img, range;\r\n        $img = $(e.currentTarget);\r\n        range = document.createRange();\r\n        range.selectNode($img[0]);\r\n        _this.editor.editable.selection.range(range);\r\n        if (!_this.editor.editable.util.support.onselectionchange) {\r\n          _this.editor.trigger('selectionchanged');\r\n        }\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.editor.body.on('mouseup', 'img:not([data-non-image])', function(e) {\r\n      return false;\r\n    });\r\n    this.editor.on('selectionchanged.image', (function(_this) {\r\n      return function() {\r\n        var $contents, $img, range;\r\n        range = _this.editor.editable.selection.range();\r\n        if (range == null) {\r\n          return;\r\n        }\r\n        $contents = $(range.cloneContents()).contents();\r\n        if ($contents.length === 1 && $contents.is('img:not([data-non-image])')) {\r\n          $img = $(range.startContainer).contents().eq(range.startOffset);\r\n          return _this.popover.show($img);\r\n        } else {\r\n          return _this.popover.hide();\r\n        }\r\n      };\r\n    })(this));\r\n    this.editor.on('valuechanged.image', (function(_this) {\r\n      return function() {\r\n        var $masks;\r\n        $masks = _this.editor.wrapper.find('.richeditor-image-loading');\r\n        if (!($masks.length > 0)) {\r\n          return;\r\n        }\r\n        return $masks.each(function(i, mask) {\r\n          var $img, $mask, file;\r\n          $mask = $(mask);\r\n          $img = $mask.data('img');\r\n          if (!($img && $img.parent().length > 0)) {\r\n            $mask.remove();\r\n            if ($img) {\r\n              file = $img.data('file');\r\n              if (file) {\r\n                _this.editor.uploader.cancel(file);\r\n                if (_this.editor.body.find('img.uploading').length < 1) {\r\n                  return _this.editor.uploader.trigger('uploadready', [file]);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        });\r\n      };\r\n    })(this));\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  ImageButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Button.prototype.render.apply(this, args);\r\n    this.popover = new ImagePopover({\r\n      button: this\r\n    });\r\n    if (this.editor.opts.imageButton === 'upload') {\r\n      return this._initUploader(this.el);\r\n    }\r\n  };\r\n\r\n  ImageButton.prototype.renderMenu = function() {\r\n    Button.prototype.renderMenu.call(this);\r\n    return this._initUploader();\r\n  };\r\n\r\n  ImageButton.prototype._initUploader = function($uploadItem) {\r\n    var $input, createInput, uploadProgress;\r\n    if ($uploadItem == null) {\r\n      $uploadItem = this.menuEl.find('.menu-item-upload-image');\r\n    }\r\n    if (this.editor.uploader == null) {\r\n      this.el.find('.btn-upload').remove();\r\n      return;\r\n    }\r\n    $input = null;\r\n    createInput = (function(_this) {\r\n      return function() {\r\n        if ($input) {\r\n          $input.remove();\r\n        }\r\n        return $input = $('<input/>', {\r\n          type: 'file',\r\n          title: _this._t('uploadImage'),\r\n          multiple: true,\r\n          accept: 'image/gif,image/jpeg,image/jpg,image/png,image/svg'\r\n        }).appendTo($uploadItem);\r\n      };\r\n    })(this);\r\n    createInput();\r\n    $uploadItem.on('click mousedown', 'input[type=file]', function(e) {\r\n      return e.stopPropagation();\r\n    });\r\n    $uploadItem.on('change', 'input[type=file]', (function(_this) {\r\n      return function(e) {\r\n        if (_this.editor.editable.inputManager.focused) {\r\n          _this.editor.uploader.upload($input, {\r\n            inline: true\r\n          });\r\n          createInput();\r\n        } else {\r\n          _this.editor.one('focus', function(e) {\r\n            _this.editor.uploader.upload($input, {\r\n              inline: true\r\n            });\r\n            return createInput();\r\n          });\r\n          _this.editor.focus();\r\n        }\r\n        return _this.wrapper.removeClass('menu-on');\r\n      };\r\n    })(this));\r\n    this.editor.uploader.on('beforeupload', (function(_this) {\r\n      return function(e, file) {\r\n        var $img;\r\n        if (!file.inline) {\r\n          return;\r\n        }\r\n        if (file.img) {\r\n          $img = $(file.img);\r\n        } else {\r\n          $img = _this.createImage(file.name);\r\n          file.img = $img;\r\n        }\r\n        $img.addClass('uploading');\r\n        $img.data('file', file);\r\n        return _this.editor.uploader.readImageFile(file.obj, function(img) {\r\n          var src;\r\n          if (!$img.hasClass('uploading')) {\r\n            return;\r\n          }\r\n          src = img ? img.src : _this.defaultImage;\r\n          return _this.loadImage($img, src, function() {\r\n            if (_this.popover.active) {\r\n              _this.popover.refresh();\r\n              return _this.popover.srcEl.val(_this._t('uploading')).prop('disabled', true);\r\n            }\r\n          });\r\n        });\r\n      };\r\n    })(this));\r\n    uploadProgress = langx.proxy(this.editor.editable.util.throttle(function(e, file, loaded, total) {\r\n      var $img, $mask, percent;\r\n      if (!file.inline) {\r\n        return;\r\n      }\r\n      $mask = file.img.data('mask');\r\n      if (!$mask) {\r\n        return;\r\n      }\r\n      $img = $mask.data('img');\r\n      if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\r\n        $mask.remove();\r\n        return;\r\n      }\r\n      percent = loaded / total;\r\n      percent = (percent * 100).toFixed(0);\r\n      if (percent > 99) {\r\n        percent = 99;\r\n      }\r\n      return $mask.find('.progress').height((100 - percent) + \"%\");\r\n    }, 500), this);\r\n    this.editor.uploader.on('uploadprogress', uploadProgress);\r\n    this.editor.uploader.on('uploadsuccess', (function(_this) {\r\n      return function(e, file, result) {\r\n        var $img, img_path, msg;\r\n        if (!file.inline) {\r\n          return;\r\n        }\r\n        $img = file.img;\r\n        if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\r\n          return;\r\n        }\r\n        if (typeof result !== 'object') {\r\n          try {\r\n            result = JSON.parse(result);\r\n          } catch (_error) {\r\n            e = _error;\r\n            result = {\r\n              success: false\r\n            };\r\n          }\r\n        }\r\n        if (result.success === false) {\r\n          msg = result.msg || _this._t('uploadFailed');\r\n          alert(msg);\r\n          img_path = _this.defaultImage;\r\n        } else {\r\n          img_path = result.file_path;\r\n        }\r\n        _this.loadImage($img, img_path, function() {\r\n          var $mask;\r\n          $img.removeData('file');\r\n          $img.removeClass('uploading').removeClass('loading');\r\n          $mask = $img.data('mask');\r\n          if ($mask) {\r\n            $mask.remove();\r\n          }\r\n          $img.removeData('mask');\r\n          _this.editor.trigger('valuechanged');\r\n          if (_this.editor.body.find('img.uploading').length < 1) {\r\n            return _this.editor.uploader.trigger('uploadready', [file, result]);\r\n          }\r\n        });\r\n        if (_this.popover.active) {\r\n          _this.popover.srcEl.prop('disabled', false);\r\n          return _this.popover.srcEl.val(result.file_path);\r\n        }\r\n      };\r\n    })(this));\r\n    return this.editor.uploader.on('uploaderror', (function(_this) {\r\n      return function(e, file, xhr) {\r\n        var $img, msg, result;\r\n        if (!file.inline) {\r\n          return;\r\n        }\r\n        if (xhr.statusText === 'abort') {\r\n          return;\r\n        }\r\n        if (xhr.responseText) {\r\n          try {\r\n            result = JSON.parse(xhr.responseText);\r\n            msg = result.msg;\r\n          } catch (_error) {\r\n            e = _error;\r\n            msg = _this._t('uploadError');\r\n          }\r\n        }\r\n        $img = file.img;\r\n        if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\r\n          return;\r\n        }\r\n        _this.loadImage($img, _this.defaultImage, function() {\r\n          var $mask;\r\n          $img.removeData('file');\r\n          $img.removeClass('uploading').removeClass('loading');\r\n          $mask = $img.data('mask');\r\n          if ($mask) {\r\n            $mask.remove();\r\n          }\r\n          return $img.removeData('mask');\r\n        });\r\n        if (_this.popover.active) {\r\n          _this.popover.srcEl.prop('disabled', false);\r\n          _this.popover.srcEl.val(_this.defaultImage);\r\n        }\r\n        _this.editor.trigger('valuechanged');\r\n        if (_this.editor.body.find('img.uploading').length < 1) {\r\n          return _this.editor.uploader.trigger('uploadready', [file, result]);\r\n        }\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ImageButton.prototype._status = function() {\r\n    return this._disableStatus();\r\n  };\r\n\r\n  ImageButton.prototype.loadImage = function($img, src, callback) {\r\n    var $mask, img, positionMask;\r\n    positionMask = (function(_this) {\r\n      return function() {\r\n        var imgOffset, wrapperOffset;\r\n        imgOffset = $img.offset();\r\n        wrapperOffset = _this.editor.wrapper.offset();\r\n        return $mask.css({\r\n          top: imgOffset.top - wrapperOffset.top,\r\n          left: imgOffset.left - wrapperOffset.left,\r\n          width: $img.width(),\r\n          height: $img.height()\r\n        }).show();\r\n      };\r\n    })(this);\r\n    $img.addClass('loading');\r\n    $mask = $img.data('mask');\r\n    if (!$mask) {\r\n      $mask = $('<div class=\"richeditor-image-loading\">\\n  <div class=\"progress\"></div>\\n</div>').hide().appendTo(this.editor.wrapper);\r\n      positionMask();\r\n      $img.data('mask', $mask);\r\n      $mask.data('img', $img);\r\n    }\r\n    img = new Image();\r\n    img.onload = (function(_this) {\r\n      return function() {\r\n        var height, width;\r\n        if (!$img.hasClass('loading') && !$img.hasClass('uploading')) {\r\n          return;\r\n        }\r\n        width = img.width;\r\n        height = img.height;\r\n        $img.attr({\r\n          src: src,\r\n          width: width,\r\n          height: height,\r\n          'data-image-size': width + ',' + height\r\n        }).removeClass('loading');\r\n        if ($img.hasClass('uploading')) {\r\n          _this.editor.editable.util.reflow(_this.editor.body);\r\n          positionMask();\r\n        } else {\r\n          $mask.remove();\r\n          $img.removeData('mask');\r\n        }\r\n        if (langx.isFunction(callback)) {\r\n          return callback(img);\r\n        }\r\n      };\r\n    })(this);\r\n    img.onerror = function() {\r\n      if (langx.isFunction(callback)) {\r\n        callback(false);\r\n      }\r\n      $mask.remove();\r\n      return $img.removeData('mask').removeClass('loading');\r\n    };\r\n    return img.src = src;\r\n  };\r\n\r\n  ImageButton.prototype.createImage = function(name) {\r\n    var $img, range;\r\n    if (name == null) {\r\n      name = 'Image';\r\n    }\r\n    if (!this.editor.editable.inputManager.focused) {\r\n      this.editor.focus();\r\n    }\r\n    range = this.editor.editable.selection.range();\r\n    range.deleteContents();\r\n    this.editor.editable.selection.range(range);\r\n    $img = $('<img/>').attr('alt', name);\r\n    range.insertNode($img[0]);\r\n    this.editor.editable.selection.setRangeAfter($img, range);\r\n    this.editor.trigger('valuechanged');\r\n    return $img;\r\n  };\r\n\r\n  ImageButton.prototype.command = function(src) {\r\n    var $img;\r\n    $img = this.createImage();\r\n    return this.loadImage($img, src || this.defaultImage, (function(_this) {\r\n      return function() {\r\n        _this.editor.trigger('valuechanged');\r\n        _this.editor.editable.util.reflow($img);\r\n        $img.click();\r\n        return _this.popover.one('popovershow', function() {\r\n          _this.popover.srcEl.focus();\r\n          return _this.popover.srcEl[0].select();\r\n        });\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(ImageButton);\t\r\n\r\n  return ImageButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/IndentButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n   var IndentButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  IndentButton.prototype.name = 'indent';\r\n\r\n  IndentButton.prototype.icon = 'indent';\r\n\r\n  IndentButton.prototype._init = function() {\r\n    var hotkey;\r\n    hotkey = this.editor.opts.tabIndent === false ? '' : ' (Tab)';\r\n    this.title = this._t(this.name) + hotkey;\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  IndentButton.prototype._status = function() {};\r\n\r\n  IndentButton.prototype.command = function() {\r\n    return this.editor.editable.indent();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(IndentButton);\t\r\n\r\n  return IndentButton;\r\n});\ndefine('skylark-widgets-richeditor/buttons/ItalicButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n\r\n  var ItalicButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  ItalicButton.prototype.name = 'italic';\r\n\r\n  ItalicButton.prototype.icon = 'italic';\r\n\r\n  ItalicButton.prototype.htmlTag = 'i';\r\n\r\n  ItalicButton.prototype.disableTag = 'pre';\r\n\r\n  ItalicButton.prototype.shortcut = 'cmd+i';\r\n\r\n  ItalicButton.prototype._init = function() {\r\n    if (this.editor.editable.util.os.mac) {\r\n      this.title = this.title + \" ( Cmd + i )\";\r\n    } else {\r\n      this.title = this.title + \" ( Ctrl + i )\";\r\n      this.shortcut = 'ctrl+i';\r\n    }\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  ItalicButton.prototype._activeStatus = function() {\r\n    var active;\r\n    active = this.editor.editable.isActive('italic');\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  ItalicButton.prototype.command = function() {\r\n    return this.editor.editable.italic();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(ItalicButton); \r\n\r\n  return ItalicButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/LinkPopover',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Popover\"\r\n],function($,Toolbar,RichEditor,Popover){ \r\n  var LinkPopover = Popover.inherit({\r\n\r\n  });\r\n\r\n  LinkPopover.prototype.render = function() {\r\n    var tpl;\r\n    tpl = \"<div class=\\\"link-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkText')) + \"</label>\\n    <input class=\\\"link-text\\\" type=\\\"text\\\"/>\\n    <a class=\\\"btn-unlink\\\" href=\\\"javascript:;\\\" title=\\\"\" + (this._t('removeLink')) + \"\\\"\\n      tabindex=\\\"-1\\\">\\n      <span class=\\\"richeditor-icon richeditor-icon-unlink\\\"></span>\\n    </a>\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkUrl')) + \"</label>\\n    <input class=\\\"link-url\\\" type=\\\"text\\\"/>\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkTarget')) + \"</label>\\n    <select class=\\\"link-target\\\">\\n      <option value=\\\"_blank\\\">\" + (this._t('openLinkInNewWindow')) + \" (_blank)</option>\\n      <option value=\\\"_self\\\">\" + (this._t('openLinkInCurrentWindow')) + \" (_self)</option>\\n    </select>\\n  </div>\\n</div>\";\r\n    this.el.addClass('link-popover').append(tpl);\r\n    this.textEl = this.el.find('.link-text');\r\n    this.urlEl = this.el.find('.link-url');\r\n    this.unlinkEl = this.el.find('.btn-unlink');\r\n    this.selectTarget = this.el.find('.link-target');\r\n    this.textEl.on('keyup', (function(_this) {\r\n      return function(e) {\r\n        if (e.which === 13) {\r\n          return;\r\n        }\r\n        _this.target.text(_this.textEl.val());\r\n        return _this.editor.editable.inputManager.throttledValueChanged();\r\n      };\r\n    })(this));\r\n    this.urlEl.on('keyup', (function(_this) {\r\n      return function(e) {\r\n        var val;\r\n        if (e.which === 13) {\r\n          return;\r\n        }\r\n        val = _this.urlEl.val();\r\n        if (!(/^(http|https|ftp|ftps|file)?:\\/\\/|^(mailto|tel)?:|^\\//ig.test(val) || !val)) {\r\n          val = 'http://' + val;\r\n        }\r\n        _this.target.attr('href', val);\r\n        return _this.editor.editable.inputManager.throttledValueChanged();\r\n      };\r\n    })(this));\r\n    $([this.urlEl[0], this.textEl[0]]).on('keydown', (function(_this) {\r\n      return function(e) {\r\n        var range;\r\n        if (e.which === 13 || e.which === 27 || (!e.shiftKey && e.which === 9 && $(e.target).hasClass('link-url'))) {\r\n          e.preventDefault();\r\n          range = document.createRange();\r\n          _this.editor.editable.selection.setRangeAfter(_this.target, range);\r\n          _this.hide();\r\n          return _this.editor.editable.inputManager.throttledValueChanged();\r\n        }\r\n      };\r\n    })(this));\r\n    this.unlinkEl.on('click', (function(_this) {\r\n      return function(e) {\r\n        var range, txtNode;\r\n        txtNode = document.createTextNode(_this.target.text());\r\n        _this.target.replaceWith(txtNode);\r\n        _this.hide();\r\n        range = document.createRange();\r\n        _this.editor.editable.selection.setRangeAfter(txtNode, range);\r\n        return _this.editor.editable.inputManager.throttledValueChanged();\r\n      };\r\n    })(this));\r\n    return this.selectTarget.on('change', (function(_this) {\r\n      return function(e) {\r\n        _this.target.attr('target', _this.selectTarget.val());\r\n        return _this.editor.editable.inputManager.throttledValueChanged();\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  LinkPopover.prototype.show = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Popover.prototype.show.apply(this, args);\r\n    this.textEl.val(this.target.text());\r\n    return this.urlEl.val(this.target.attr('href'));\r\n  };\r\n\r\n  return LinkPopover;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/LinkButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\",\r\n  \"./LinkPopover\"\r\n],function($,Toolbar,RichEditor,Button,i18n,LinkPopover){ \r\n  \r\n\r\n  var LinkButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  LinkButton.prototype.name = 'link';\r\n\r\n  LinkButton.prototype.icon = 'link';\r\n\r\n  LinkButton.prototype.htmlTag = 'a';\r\n\r\n  LinkButton.prototype.disableTag = 'pre';\r\n\r\n  LinkButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Button.prototype.render.apply(this, args);\r\n    return this.popover = new LinkPopover({\r\n      button: this\r\n    });\r\n  };\r\n\r\n  LinkButton.prototype._status = function() {\r\n   Button.prototype._status.call(this);\r\n    if (this.active && !this.editor.editable.selection.rangeAtEndOf(this.node)) {\r\n      return this.popover.show(this.node);\r\n    } else {\r\n      return this.popover.hide();\r\n    }\r\n  };\r\n\r\n  LinkButton.prototype.command = function() {\r\n    if (this.active) {\r\n      this.popover.one('popovershow', (function(_this) {\r\n        return function() {\r\n          if (linkText) {\r\n            _this.popover.urlEl.focus();\r\n            return _this.popover.urlEl[0].select();\r\n          } else {\r\n            _this.popover.textEl.focus();\r\n            return _this.popover.textEl[0].select();\r\n          }\r\n        };\r\n      })(this));\r\n\r\n    }\r\n\r\n    return this.editor.editable.link(this.active,i18n.translate('linkText'));\r\n\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(LinkButton);\r\n\r\n  return LinkButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/ListButton',[\r\n  \"skylark-utils-dom/noder\",\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function(noder,$,Toolbar,RichEditor,Button){ \r\n  var ListButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n    ListButton.prototype.type = '';\r\n\r\n    ListButton.prototype.disableTag = 'pre, table';\r\n\r\n    ListButton.prototype.command = function(param) {\r\n      return this.editor.editable.list(this.type,param,this.disableTag);\r\n    };\r\n\r\n    return ListButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/MarkButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n\r\n\r\n  var MarkButton = Button.inherit({\r\n    name : 'mark'\r\n\r\n  });\r\n\r\n\r\n  MarkButton.prototype.icon = 'mark';\r\n\r\n  MarkButton.prototype.htmlTag = 'mark';\r\n\r\n  MarkButton.prototype.disableTag = 'pre, table';\r\n\r\n  MarkButton.prototype.command = function() {\r\n    var $end, $start, range;\r\n    range = this.editor.editable.selection.range();\r\n    if (this.active) {\r\n      this.editor.editable.selection.save();\r\n      this.unmark(range);\r\n      this.editor.editable.selection.restore();\r\n      this.editor.trigger('valuechanged');\r\n      return;\r\n    }\r\n    if (range.collapsed) {\r\n      return;\r\n    }\r\n    this.editor.editable.selection.save();\r\n    $start = $(range.startContainer);\r\n    $end = $(range.endContainer);\r\n    if ($start.closest('mark').length) {\r\n      range.setStartBefore($start.closest('mark')[0]);\r\n    }\r\n    if ($end.closest('mark').length) {\r\n      range.setEndAfter($end.closest('mark')[0]);\r\n    }\r\n    this.mark(range);\r\n    this.editor.editable.selection.restore();\r\n    this.editor.trigger('valuechanged');\r\n    if (this.editor.editable.util.support.onselectionchange) {\r\n      return this.editor.trigger('selectionchanged');\r\n    }\r\n  };\r\n\r\n  MarkButton.prototype.mark = function(range) {\r\n    var $contents, $mark;\r\n    if (range == null) {\r\n      range = this.editor.editable.selection.range();\r\n    }\r\n    $contents = $(range.extractContents());\r\n    $contents.find('mark').each(function(index, ele) {\r\n      return $(ele).replaceWith($(ele).html());\r\n    });\r\n    $mark = $('<mark>').append($contents);\r\n    return range.insertNode($mark[0]);\r\n  };\r\n\r\n  MarkButton.prototype.unmark = function(range) {\r\n    var $mark;\r\n    if (range == null) {\r\n      range = this.editor.editable.selection.range();\r\n    }\r\n    if (range.collapsed) {\r\n      $mark = $(range.commonAncestorContainer);\r\n      if (!$mark.is('mark')) {\r\n        $mark = $mark.parent();\r\n      }\r\n    } else if ($(range.startContainer).closest('mark').length) {\r\n      $mark = $(range.startContainer).closest('mark');\r\n    } else if ($(range.endContainer).closest('mark').length) {\r\n      $mark = $(range.endContainer).closest('mark');\r\n    }\r\n    return $mark.replaceWith($mark.html());\r\n  };  \r\n\r\n  \r\n  RichEditor.Toolbar.addButton(MarkButton);\r\n\r\n  return MarkButton;\r\n\r\n }); \ndefine('skylark-widgets-richeditor/buttons/OrderListButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"./ListButton\"\r\n],function($,Toolbar,RichEditor,ListButton){ \r\n  var OrderListButton = ListButton.inherit({\r\n\r\n   });\r\n\r\n\r\n    OrderListButton.prototype.type = 'ol';\r\n\r\n    OrderListButton.prototype.name = 'ol';\r\n\r\n    OrderListButton.prototype.icon = 'list-ol';\r\n\r\n    OrderListButton.prototype.htmlTag = 'ol';\r\n\r\n    OrderListButton.prototype.shortcut = 'cmd+/';\r\n\r\n    OrderListButton.prototype._init = function() {\r\n      if (this.editor.editable.util.os.mac) {\r\n        this.title = this.title + ' ( Cmd + / )';\r\n      } else {\r\n        this.title = this.title + ' ( ctrl + / )';\r\n        this.shortcut = 'ctrl+/';\r\n      }\r\n      return ListButton.prototype._init.call(this);\r\n    };\r\n\r\n    RichEditor.Toolbar.addButton(OrderListButton);\r\n\r\n    return OrderListButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/OutdentButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  var OutdentButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  OutdentButton.prototype.name = 'outdent';\r\n\r\n  OutdentButton.prototype.icon = 'outdent';\r\n\r\n  OutdentButton.prototype._init = function() {\r\n    var hotkey;\r\n    hotkey = this.editor.opts.tabIndent === false ? '' : ' (Shift + Tab)';\r\n    this.title = this._t(this.name) + hotkey;\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  OutdentButton.prototype._status = function() {};\r\n\r\n  OutdentButton.prototype.command = function() {\r\n    return this.editor.editable.outdent();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(OutdentButton);\t\r\n\r\n  return OutdentButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/StrikethroughButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n  var StrikethroughButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  StrikethroughButton.prototype.name = 'strikethrough';\r\n\r\n  StrikethroughButton.prototype.icon = 'strikethrough';\r\n\r\n  StrikethroughButton.prototype.htmlTag = 'strike';\r\n\r\n  StrikethroughButton.prototype.disableTag = 'pre';\r\n\r\n  StrikethroughButton.prototype._activeStatus = function() {\r\n    var active;\r\n    active = this.editor.editable.isActive('strikethrough');\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  StrikethroughButton.prototype.command = function() {\r\n    return this.editor.editable.strikethrough();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(StrikethroughButton);\t\r\n\r\n  return StrikethroughButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/TableButton',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-tables\",\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function(langx,tables,$,Toolbar,RichEditor,Button){ \r\n  var TableButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  TableButton.prototype.name = 'table';\r\n\r\n  TableButton.prototype.icon = 'table';\r\n\r\n  TableButton.prototype.htmlTag = 'table';\r\n\r\n  TableButton.prototype.disableTag = 'pre, li, blockquote';\r\n\r\n  TableButton.prototype.menu = true;\r\n\r\n  TableButton.prototype._init = function() {\r\n    Button.prototype._init.call(this);\r\n    langx.merge(this.editor.editable.formatter._allowedTags, ['thead', 'th', 'tbody', 'tr', 'td', 'colgroup', 'col']);\r\n    langx.extend(this.editor.editable.formatter._allowedAttributes, {\r\n      td: ['rowspan', 'colspan'],\r\n      col: ['width']\r\n    });\r\n    langx.extend(this.editor.editable.formatter._allowedStyles, {\r\n      td: ['text-align'],\r\n      th: ['text-align']\r\n    });\r\n    this._initShortcuts();\r\n    this._initResize();\r\n    this.editor.on('decorate', (function(_this) {\r\n      return function(e, $el) {\r\n        return $el.find('table').each(function(i, table) {\r\n          return _this.decorate($(table));\r\n        });\r\n      };\r\n    })(this));\r\n    this.editor.on('undecorate', (function(_this) {\r\n      return function(e, $el) {\r\n        return $el.find('table').each(function(i, table) {\r\n          return _this.undecorate($(table));\r\n        });\r\n      };\r\n    })(this));\r\n    this.editor.on('selectionchanged.table', (function(_this) {\r\n      return function(e) {\r\n        var $container, range;\r\n        _this.editor.body.find('.richeditor-table td, .richeditor-table th').removeClass('active');\r\n        range = _this.editor.editable.selection.range();\r\n        if (!range) {\r\n          return;\r\n        }\r\n        $container = _this.editor.editable.selection.containerNode();\r\n        if (range.collapsed && $container.is('.richeditor-table')) {\r\n          _this.editor.editable.selection.setRangeAtEndOf($container);\r\n        }\r\n        return $container.closest('td, th', _this.editor.body).addClass('active');\r\n      };\r\n    })(this));\r\n    this.editor.on('blur.table', (function(_this) {\r\n      return function(e) {\r\n        return _this.editor.body.find('.richeditor-table td, .richeditor-table th').removeClass('active');\r\n      };\r\n    })(this));\r\n    this.editor.editable.keystroke.add('up', 'td', (function(_this) {\r\n      return function(e, $node) {\r\n        _this._tdNav($node, 'up');\r\n        return true;\r\n      };\r\n    })(this));\r\n    this.editor.editable.keystroke.add('up', 'th', (function(_this) {\r\n      return function(e, $node) {\r\n        _this._tdNav($node, 'up');\r\n        return true;\r\n      };\r\n    })(this));\r\n    this.editor.editable.keystroke.add('down', 'td', (function(_this) {\r\n      return function(e, $node) {\r\n        _this._tdNav($node, 'down');\r\n        return true;\r\n      };\r\n    })(this));\r\n    return this.editor.editable.keystroke.add('down', 'th', (function(_this) {\r\n      return function(e, $node) {\r\n        _this._tdNav($node, 'down');\r\n        return true;\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  TableButton.prototype._tdNav = function($td, direction) {\r\n    var $anotherTr, $tr, action, anotherTag, index, parentTag, ref;\r\n    if (direction == null) {\r\n      direction = 'up';\r\n    }\r\n    action = direction === 'up' ? 'prev' : 'next';\r\n    ref = direction === 'up' ? ['tbody', 'thead'] : ['thead', 'tbody'], parentTag = ref[0], anotherTag = ref[1];\r\n    $tr = $td.parent('tr');\r\n    $anotherTr = this[\"_\" + action + \"Row\"]($tr);\r\n    if (!($anotherTr.length > 0)) {\r\n      return true;\r\n    }\r\n    index = $tr.find('td, th').index($td);\r\n    return this.editor.editable.selection.setRangeAtEndOf($anotherTr.find('td, th').eq(index));\r\n  };\r\n\r\n  TableButton.prototype._initResize = function() {\r\n\r\n    tables.resizable(document,{\r\n      cssClasses : {\r\n        resizeHandle : \"richeditor-resize-handle\",\r\n        wrapper : \"richeditor-table\"\r\n      }\r\n    });\r\n\r\n  };\r\n\r\n  TableButton.prototype._initShortcuts = function() {\r\n    this.editor.editable.hotkeys.add('ctrl+alt+up', (function(_this) {\r\n      return function(e) {\r\n        _this.editMenu.find('.menu-item[data-param=insertRowAbove]').click();\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.editor.editable.hotkeys.add('ctrl+alt+down', (function(_this) {\r\n      return function(e) {\r\n        _this.editMenu.find('.menu-item[data-param=insertRowBelow]').click();\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.editor.editable.hotkeys.add('ctrl+alt+left', (function(_this) {\r\n      return function(e) {\r\n        _this.editMenu.find('.menu-item[data-param=insertColLeft]').click();\r\n        return false;\r\n      };\r\n    })(this));\r\n    return this.editor.editable.hotkeys.add('ctrl+alt+right', (function(_this) {\r\n      return function(e) {\r\n        _this.editMenu.find('.menu-item[data-param=insertColRight]').click();\r\n        return false;\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  TableButton.prototype.renderMenu = function() {\r\n    var $table;\r\n    $(\"<div class=\\\"menu-create-table\\\">\\n</div>\\n<div class=\\\"menu-edit-table\\\">\\n  <ul>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteRow\\\">\\n        <span>\" + (this._t('deleteRow')) + \"</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertRowAbove\\\">\\n        <span>\" + (this._t('insertRowAbove')) + \" ( Ctrl + Alt +  )</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertRowBelow\\\">\\n        <span>\" + (this._t('insertRowBelow')) + \" ( Ctrl + Alt +  )</span>\\n      </a>\\n    </li>\\n    <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteCol\\\">\\n        <span>\" + (this._t('deleteColumn')) + \"</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertColLeft\\\">\\n        <span>\" + (this._t('insertColumnLeft')) + \" ( Ctrl + Alt +  )</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertColRight\\\">\\n        <span>\" + (this._t('insertColumnRight')) + \" ( Ctrl + Alt +  )</span>\\n      </a>\\n    </li>\\n    <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteTable\\\">\\n        <span>\" + (this._t('deleteTable')) + \"</span>\\n      </a>\\n    </li>\\n  </ul>\\n</div>\").appendTo(this.menuWrapper);\r\n    this.createMenu = this.menuWrapper.find('.menu-create-table');\r\n    this.editMenu = this.menuWrapper.find('.menu-edit-table');\r\n    $table = this.createTable(6, 6).appendTo(this.createMenu);\r\n    this.createMenu.on('mouseenter', 'td, th', (function(_this) {\r\n      return function(e) {\r\n        var $td, $tr, $trs, num;\r\n        _this.createMenu.find('td, th').removeClass('selected');\r\n        $td = $(e.currentTarget);\r\n        $tr = $td.parent();\r\n        num = $tr.find('td, th').index($td) + 1;\r\n        $trs = $tr.prevAll('tr').addBack();\r\n        if ($tr.parent().is('tbody')) {\r\n          $trs = $trs.add($table.find('thead tr'));\r\n        }\r\n        return $trs.find(\"td:lt(\" + num + \"), th:lt(\" + num + \")\").addClass('selected');\r\n      };\r\n    })(this));\r\n    this.createMenu.on('mouseleave', function(e) {\r\n      return $(e.currentTarget).find('td, th').removeClass('selected');\r\n    });\r\n    return this.createMenu.on('mousedown', 'td, th', (function(_this) {\r\n      return function(e) {\r\n        var $closestBlock, $td, $tr, colNum, rowNum;\r\n        _this.wrapper.removeClass('menu-on');\r\n        if (!_this.editor.editable.inputManager.focused) {\r\n          return;\r\n        }\r\n        $td = $(e.currentTarget);\r\n        $tr = $td.parent();\r\n        colNum = $tr.find('td').index($td) + 1;\r\n        rowNum = $tr.prevAll('tr').length + 1;\r\n        if ($tr.parent().is('tbody')) {\r\n          rowNum += 1;\r\n        }\r\n        $table = _this.createTable(rowNum, colNum, true);\r\n        $closestBlock = _this.editor.editable.selection.blockNodes().last();\r\n        if (_this.editor.editable.util.isEmptyNode($closestBlock)) {\r\n          $closestBlock.replaceWith($table);\r\n        } else {\r\n          $closestBlock.after($table);\r\n        }\r\n        _this.decorate($table);\r\n        _this.editor.editable.selection.setRangeAtStartOf($table.find('th:first'));\r\n        _this.editor.trigger('valuechanged');\r\n        return false;\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  TableButton.prototype.decorate = function($table) {\r\n    return $(tables.decorate($table[0],{\r\n      tableDecorate : 'richeditor-table',\r\n      resizeHandle : 'richeditor-resize-handle'\r\n    }));\r\n\r\n  };\r\n\r\n  TableButton.prototype.undecorate = function($table) {\r\n    return $(tables.undecorate($table[0],{\r\n      tableDecorate : 'richeditor-table',\r\n      resizeHandle : 'richeditor-resize-handle'\r\n    }));\r\n\r\n  };\r\n\r\n\r\n  TableButton.prototype.createTable = function(row, col, phBr) {\r\n    return $(tables.createTable(row,col,phBr ? this.editor.editable.util.phBr : null));\r\n  };\r\n\r\n  TableButton.prototype.refreshTableWidth = function($table) {\r\n    return table.refreshTableWidth($table[0]);\r\n  };\r\n\r\n  TableButton.prototype.setActive = function(active) {\r\n    Button.prototype.setActive.call(this, active);\r\n    if (active) {\r\n      this.createMenu.hide();\r\n      return this.editMenu.show();\r\n    } else {\r\n      this.createMenu.show();\r\n      return this.editMenu.hide();\r\n    }\r\n  };\r\n\r\n  TableButton.prototype.deleteRow = function($td) {\r\n    var self = this,\r\n        ret; \r\n\r\n    tables.deleteRow($td[0],function(newTr,index){\r\n      if (newTr) {\r\n        ret = self.editor.editable.selection.setRangeAtEndOf($(newTr).find('td, th').eq(index));\r\n      }\r\n    })\r\n\r\n    return ret;\r\n  };\r\n\r\n  TableButton.prototype.insertRow = function($td, direction) {\r\n    var self = this,\r\n        ret; \r\n\r\n    tables.insertRow($td[0],direction,self.editor.editable.util.phBr,function(newTr,index){\r\n      ret =  self.editor.editable.selection.setRangeAtStartOf($(newTr).find('td, th').eq(index));\r\n    })\r\n\r\n    return ret;\r\n\r\n  };\r\n\r\n  TableButton.prototype.deleteCol = function($td) {\r\n    var self = this,\r\n        ret; \r\n\r\n    tables.deleteCol($td[0],function(newTd){\r\n      if (newTd) {\r\n        ret = self.editor.editable.selection.setRangeAtEndOf($(newTd));\r\n      }\r\n    })\r\n\r\n    return ret;\r\n  };\r\n\r\n  TableButton.prototype.insertCol = function($td, direction) {\r\n    var self = this,\r\n        ret; \r\n\r\n    tables.insertCol($td[0],direction,self.editor.editable.util.phBr,function(newTd){\r\n      ret = self.editor.editable.selection.setRangeAtStartOf($(newTd));\r\n    })\r\n\r\n    return ret;\r\n  };\r\n\r\n  TableButton.prototype.deleteTable = function($td) {\r\n    var self = this;\r\n    tables.deleteTable($td[0],function($block){\r\n      if ($block.length > 0) {\r\n        return self.editor.editable.selection.setRangeAtStartOf($block);\r\n      }\r\n    });\r\n  };\r\n\r\n  TableButton.prototype.command = function(param) {\r\n    var $td;\r\n    $td = this.editor.editable.selection.containerNode().closest('td, th');\r\n    if (!($td.length > 0)) {\r\n      return;\r\n    }\r\n    if (param === 'deleteRow') {\r\n      this.deleteRow($td);\r\n    } else if (param === 'insertRowAbove') {\r\n      this.insertRow($td, 'before');\r\n    } else if (param === 'insertRowBelow') {\r\n      this.insertRow($td);\r\n    } else if (param === 'deleteCol') {\r\n      this.deleteCol($td);\r\n    } else if (param === 'insertColLeft') {\r\n      this.insertCol($td, 'before');\r\n    } else if (param === 'insertColRight') {\r\n      this.insertCol($td);\r\n    } else if (param === 'deleteTable') {\r\n      this.deleteTable($td);\r\n    } else {\r\n      return;\r\n    }\r\n    return this.editor.trigger('valuechanged');\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(TableButton);\r\n\r\n  return TableButton;\r\n\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/TitleButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n  var TitleButton = Button.inherit({\r\n\r\n   });\r\n\r\n  TitleButton.prototype.name = 'title';\r\n\r\n  TitleButton.prototype.htmlTag = 'h1, h2, h3, h4, h5';\r\n\r\n  TitleButton.prototype.disableTag = 'pre, table';\r\n\r\n  TitleButton.prototype._init = function() {\r\n    this.menu = [\r\n      {\r\n        name: 'normal',\r\n        text: i18n.translate('normalText'),\r\n        param: 'p'\r\n      }, '|', {\r\n        name: 'h1',\r\n        text: i18n.translate('title') + ' 1',\r\n        param: 'h1'\r\n      }, {\r\n        name: 'h2',\r\n        text: i18n.translate('title') + ' 2',\r\n        param: 'h2'\r\n      }, {\r\n        name: 'h3',\r\n        text: i18n.translate('title') + ' 3',\r\n        param: 'h3'\r\n      }, {\r\n        name: 'h4',\r\n        text: i18n.translate('title') + ' 4',\r\n        param: 'h4'\r\n      }, {\r\n        name: 'h5',\r\n        text: i18n.translate('title') + ' 5',\r\n        param: 'h5'\r\n      }\r\n    ];\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  TitleButton.prototype.setActive = function(active, param) {\r\n    Button.prototype.setActive.call(this, active);\r\n    if (active) {\r\n      param || (param = this.node[0].tagName.toLowerCase());\r\n    }\r\n    this.el.removeClass('active-p active-h1 active-h2 active-h3 active-h4 active-h5');\r\n    if (active) {\r\n      return this.el.addClass('active active-' + param);\r\n    }\r\n  };\r\n\r\n  TitleButton.prototype.command = function(param) {\r\n    return this.editor.editable.title(param,this.disableTag);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(TitleButton);\r\n\r\n  return TitleButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/UnderlineButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){\r\n  var UnderlineButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  UnderlineButton.prototype.name = 'underline';\r\n\r\n  UnderlineButton.prototype.icon = 'underline';\r\n\r\n  UnderlineButton.prototype.htmlTag = 'u';\r\n\r\n  UnderlineButton.prototype.disableTag = 'pre';\r\n\r\n  UnderlineButton.prototype.shortcut = 'cmd+u';\r\n\r\n  UnderlineButton.prototype.render = function() {\r\n    if (this.editor.editable.util.os.mac) {\r\n      this.title = this.title + ' ( Cmd + u )';\r\n    } else {\r\n      this.title = this.title + ' ( Ctrl + u )';\r\n      this.shortcut = 'ctrl+u';\r\n    }\r\n    return Button.prototype.render.call(this);\r\n  };\r\n\r\n  UnderlineButton.prototype._activeStatus = function() {\r\n    var active;\r\n    active = this.editor.editable.isActive('underline');\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  UnderlineButton.prototype.command = function() {\r\n    return this.editor.editable.underline();\r\n  };\r\n\r\n\r\n  RichEditor.Toolbar.addButton(UnderlineButton);\r\n\r\n  return UnderlineButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/UnorderListButton',[\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"./ListButton\"\r\n],function($,Toolbar,RichEditor,ListButton){ \r\n   var UnorderListButton = ListButton.inherit({\r\n\r\n   });\r\n\r\n    UnorderListButton.prototype.type = 'ul';\r\n\r\n    UnorderListButton.prototype.name = 'ul';\r\n\r\n    UnorderListButton.prototype.icon = 'list-ul';\r\n\r\n    UnorderListButton.prototype.htmlTag = 'ul';\r\n\r\n    UnorderListButton.prototype.shortcut = 'cmd+.';\r\n\r\n    UnorderListButton.prototype._init = function() {\r\n      if (this.editor.editable.util.os.mac) {\r\n        this.title = this.title + ' ( Cmd + . )';\r\n      } else {\r\n        this.title = this.title + ' ( Ctrl + . )';\r\n        this.shortcut = 'ctrl+.';\r\n      }\r\n      return ListButton.prototype._init.call(this);\r\n    };\r\n\r\n    RichEditor.Toolbar.addButton(UnorderListButton);  \r\n\r\n    return UnorderListButton;\r\n\r\n});\ndefine('skylark-widgets-base/Addon',[\r\n\t\"./base\",\r\n  \"skylark-langx/Evented\"\t\r\n],function(base,Evented){\r\n\r\n\tvar Addon = Evented.inherit({\r\n\r\n\t\t_construct : function(widget,options) {\r\n\t\t\tthis._widget = widget;\r\n\t\t\tthis._options = options;\r\n\t\t\tif (this._init) {\r\n\t\t\t\tthis._init();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n\r\n\treturn base.Addon = Addon;\r\n\r\n});\ndefine('skylark-widgets-richeditor/addons/AutoSave',[\r\n  \"skylark-domx-query\",\r\n  \"skylark-widgets-base/Addon\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Addon, Toolbar,RichEditor,Button,i18n){ \r\n\r\n\r\n  var AutoSave = Addon.inherit({\r\n    needFocus : false,\r\n\r\n    _init : function() {\r\n\r\n\t    var currentVal, link, name, val;\r\n\t    this.editor = this._module;\r\n\t    if (!this.opts.autosave) {\r\n\t      return;\r\n\t    }\r\n\t    this.name = typeof this.opts.autosave === 'string' ? this.opts.autosave : 'simditor';\r\n\t    if (this.opts.autosavePath) {\r\n\t      this.path = this.opts.autosavePath;\r\n\t    } else {\r\n\t      link = $(\"<a/>\", {\r\n\t        href: location.href\r\n\t      });\r\n\t      name = this.editor.textarea.data('autosave') || this.name;\r\n\t      this.path = \"/\" + (link[0].pathname.replace(/\\/$/g, \"\").replace(/^\\//g, \"\")) + \"/autosave/\" + name + \"/\";\r\n\t    }\r\n\t    if (!this.path) {\r\n\t      return;\r\n\t    }\r\n\t    this.editor.on(\"valuechanged\", (function(_this) {\r\n\t      return function() {\r\n\t        return _this.storage.set(_this.path, _this.editor.getValue());\r\n\t      };\r\n\t    })(this));\r\n\t    this.editor.el.closest('form').on('ajax:success.simditor-' + this.editor.id, (function(_this) {\r\n\t      return function(e) {\r\n\t        return _this.storage.remove(_this.path);\r\n\t      };\r\n\t    })(this));\r\n\t    val = this.storage.get(this.path);\r\n\t    if (!val) {\r\n\t      return;\r\n\t    }\r\n\t    currentVal = this.editor.textarea.val();\r\n\t    if (val === currentVal) {\r\n\t      return;\r\n\t    }\r\n\t    if (this.editor.textarea.is('[data-autosave-confirm]')) {\r\n\t      if (confirm(this.editor.textarea.data('autosave-confirm') || 'Are you sure to restore unsaved changes?')) {\r\n\t        return this.editor.setValue(val);\r\n\t      } else {\r\n\t        return this.storage.remove(this.path);\r\n\t      }\r\n\t    } else {\r\n\t      return this.editor.setValue(val);\r\n\t    }\r\n\r\n    }\r\n\r\n  });\r\n\r\n\r\n  AutoSave.categoryName = \"general\";\r\n  AutoSave.addonName = 'autosave';\r\n\r\n  AutoSave.prototype.opts = {\r\n    autosave: true,\r\n    autosavePath: null\r\n  };\r\n\r\n\r\n  AutoSave.prototype.storage = {\r\n    supported: function() {\r\n      var error;\r\n      try {\r\n        localStorage.setItem('_storageSupported', 'yes');\r\n        localStorage.removeItem('_storageSupported');\r\n        return true;\r\n      } catch (_error) {\r\n        error = _error;\r\n        return false;\r\n      }\r\n    },\r\n    set: function(key, val, session) {\r\n      var storage;\r\n      if (session == null) {\r\n        session = false;\r\n      }\r\n      if (!this.supported()) {\r\n        return;\r\n      }\r\n      storage = session ? sessionStorage : localStorage;\r\n      return storage.setItem(key, val);\r\n    },\r\n    get: function(key, session) {\r\n      var storage;\r\n      if (session == null) {\r\n        session = false;\r\n      }\r\n      if (!this.supported()) {\r\n        return;\r\n      }\r\n      storage = session ? sessionStorage : localStorage;\r\n      return storage[key];\r\n    },\r\n    remove: function(key, session) {\r\n      var storage;\r\n      if (session == null) {\r\n        session = false;\r\n      }\r\n      if (!this.supported()) {\r\n        return;\r\n      }\r\n      storage = session ? sessionStorage : localStorage;\r\n      return storage.removeItem(key);\r\n    }\r\n  };\r\n\r\n  return RichEditor.addons.general.autoSave = AutoSave;\r\n\r\n});\ndefine('skylark-widgets-richeditor/addons/Dropzone',[\r\n  \"skylark-domx-query\",\r\n  \"skylark-widgets-base/Addon\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Addon, Toolbar,RichEditor,Button,i18n){ \r\n\r\n\r\n  var Dropzone = Addon.inherit({\r\n  });\r\n\r\n  Dropzone.categoryName = \"genernal\";\r\n\r\n  Dropzone.addonName = \"dropzone\";\r\n\r\n\r\n  Dropzone.prototype._entered = 0;\r\n\r\n  Dropzone.prototype._init = function() {\r\n    this.editor = this._widget;\r\n    if (this.editor.uploader == null) {\r\n      throw new Error(\"Can't work without 'simple-uploader' module\");\r\n      return;\r\n    }\r\n    $(document.body).on(\"dragover\", function(e) {\r\n      e.originalEvent.dataTransfer.dropEffect = \"none\";\r\n      return e.preventDefault();\r\n    });\r\n    $(document.body).on('drop', function(e) {\r\n      return e.preventDefault();\r\n    });\r\n    this.imageBtn = this.editor.toolbar.findButton(\"image\");\r\n    return this.editor.body.on(\"dragover\", function(e) {\r\n      e.originalEvent.dataTransfer.dropEffect = \"copy\";\r\n      e.stopPropagation();\r\n      return e.preventDefault();\r\n    }).on(\"dragenter\", (function(_this) {\r\n      return function(e) {\r\n        if ((_this._entered += 1) === 1) {\r\n          _this.show();\r\n        }\r\n        e.preventDefault();\r\n        return e.stopPropagation();\r\n      };\r\n    })(this)).on(\"dragleave\", (function(_this) {\r\n      return function(e) {\r\n        if ((_this._entered -= 1) <= 0) {\r\n          _this.hide();\r\n        }\r\n        e.preventDefault();\r\n        return e.stopPropagation();\r\n      };\r\n    })(this)).on(\"drop\", (function(_this) {\r\n      return function(e) {\r\n        var file, imageFiles, _i, _j, _len, _len1, _ref;\r\n        imageFiles = [];\r\n        _ref = e.originalEvent.dataTransfer.files;\r\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n          file = _ref[_i];\r\n          if (!_this.validFile(file)) {\r\n            alert(\"\" + file.name + \"]\");\r\n            _this.hide();\r\n            return false;\r\n          }\r\n          imageFiles.push(file);\r\n        }\r\n        for (_j = 0, _len1 = imageFiles.length; _j < _len1; _j++) {\r\n          file = imageFiles[_j];\r\n          _this.editor.uploader.upload(file, {\r\n            inline: true\r\n          });\r\n        }\r\n        _this.hide();\r\n        e.stopPropagation();\r\n        return e.preventDefault();\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  Dropzone.prototype.show = function() {\r\n    return this.imageBtn.setActive(true);\r\n  };\r\n\r\n  Dropzone.prototype.hide = function() {\r\n    this.imageBtn.setActive(false);\r\n    return this._entered = 0;\r\n  };\r\n\r\n  Dropzone.prototype.validFile = function(file) {\r\n    return file.type.indexOf(\"image/\") > -1;\r\n  };\r\n\r\n  return RichEditor.addons.general.dropzone = Dropzone;\r\n\r\n\r\n});\ndefine('skylark-widgets-richeditor/main',[\r\n  \"./RichEditor\", \r\n  \"./Button\", \r\n  \"./Popover\", \r\n\r\n  \"./buttons/AlignmentButton\", \r\n  \"./buttons/BlockquoteButton\", \r\n  \"./buttons/BoldButton\", \r\n  \"./buttons/CodeButton\", \r\n  \"./buttons/CodePopover\", \r\n  \"./buttons/ColorButton\", \r\n  \"./buttons/EmojiButton\", \r\n  \"./buttons/FontScaleButton\", \r\n  \"./buttons/FullScreenButton\", \r\n  \"./buttons/HrButton\", \r\n  \"./buttons/HtmlButton\", \r\n  \"./buttons/ImageButton\", \r\n  \"./buttons/ImagePopover\", \r\n  \"./buttons/IndentButton\", \r\n  \"./buttons/ItalicButton\", \r\n  \"./buttons/LinkButton\", \r\n  \"./buttons/LinkPopover\", \r\n  \"./buttons/ListButton\", \r\n  \"./buttons/MarkButton\", \r\n  \"./buttons/OrderListButton\", \r\n  \"./buttons/OutdentButton\",\r\n  \"./buttons/StrikethroughButton\", \r\n  \"./buttons/TableButton\", \r\n  \"./buttons/TitleButton\", \r\n  \"./buttons/UnderlineButton\", \r\n  \"./buttons/UnorderListButton\",\r\n  \"./addons/AutoSave\",\r\n  \"./addons/Dropzone\"\r\n],function(RichEditor){\r\n\t\r\n  return RichEditor;\r\n});\ndefine('skylark-widgets-richeditor', ['skylark-widgets-richeditor/main'], function (main) { return main; });\n\n"]}